2025-03-19 14:34:04 INFO  tech.robd.jwt.JwtAuthApplication - Starting JwtAuthApplication using Java 21.0.3 with PID 26676 (C:\data\work\myframework\simple-spring-jwt-auth\build\classes\java\main started by robde in C:\data\work\myframework\simple-spring-jwt-auth)
2025-03-19 14:34:04 DEBUG tech.robd.jwt.JwtAuthApplication - Running with Spring Boot v3.1.2, Spring v6.0.11
2025-03-19 14:34:04 INFO  tech.robd.jwt.JwtAuthApplication - The following 1 profile is active: "dev"
2025-03-19 14:34:05 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-19 14:34:06 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 68 ms. Found 3 JPA repository interfaces.
2025-03-19 14:34:06 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8081 (http)
2025-03-19 14:34:06 INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-03-19 14:34:06 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-03-19 14:34:06 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.11]
2025-03-19 14:34:06 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-03-19 14:34:06 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2023 ms
2025-03-19 14:34:07 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-03-19 14:34:07 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:jwt_auth user=SA
2025-03-19 14:34:07 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-03-19 14:34:07 INFO  o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:jwt_auth'
2025-03-19 14:34:07 INFO  tech.robd.jwt.util.JwtTokenUtil - JWT secret key loaded from file successfully
2025-03-19 14:34:07 DEBUG t.r.j.filter.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-03-19 14:34:07 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-19 14:34:07 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.2.6.Final
2025-03-19 14:34:07 INFO  org.hibernate.cfg.Environment - HHH000406: Using bytecode reflection optimizer
2025-03-19 14:34:07 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 14:34:07 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-19 14:34:08 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 14:34:09 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-03-19 14:34:09 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 14:34:09 ERROR t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST ERROR LOG - Should appear in console
2025-03-19 14:34:09 WARN  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST WARNING LOG - Should appear in console
2025-03-19 14:34:09 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST INFO LOG - Should appear in console
2025-03-19 14:34:09 DEBUG t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST DEBUG LOG - May or may not appear depending on level
2025-03-19 14:34:09 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST SECURITY LOG - Should appear in security log
2025-03-19 14:34:09 INFO  t.r.jwt.service.DatabaseInitService - Initializing database with domains, roles and users from configuration
2025-03-19 14:34:10 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "b119e" for domain: app1
2025-03-19 14:34:10 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: app1
2025-03-19 14:34:10 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "16c70" for domain: default
2025-03-19 14:34:10 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: default
2025-03-19 14:34:10 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 14:34:10 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 14:34:10 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 14:34:10 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 14:34:10 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 14:34:10 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 14:34:10 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "b119e" for user admin1 in domain: app1
2025-03-19 14:34:10 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user admin1 in domain app1: ADMIN
2025-03-19 14:34:10 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: admin1 in domain: app1
2025-03-19 14:34:10 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "b119e" for user user1 in domain: app1
2025-03-19 14:34:10 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user1 in domain app1: USER
2025-03-19 14:34:10 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user1 in domain: app1
2025-03-19 14:34:10 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "b119e" for user user2 in domain: app1
2025-03-19 14:34:10 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user2 in domain app1: USER
2025-03-19 14:34:10 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user2 in domain: app1
2025-03-19 14:34:10 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "b119e" for user user3 in domain: app1
2025-03-19 14:34:10 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user3 in domain app1: USER
2025-03-19 14:34:10 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user3 in domain: app1
2025-03-19 14:34:10 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "b119e" for user manager1 in domain: app1
2025-03-19 14:34:10 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: MANAGER
2025-03-19 14:34:10 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: USER
2025-03-19 14:34:10 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: manager1 in domain: app1
2025-03-19 14:34:11 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-03-19 14:34:11 WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: f70fa7bb-c775-4d9a-8c6e-8c6f0b753d16

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-03-19 14:34:11 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@6d76aa05, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@2403c1c5, org.springframework.security.web.context.SecurityContextHolderFilter@101eb529, org.springframework.security.web.header.HeaderWriterFilter@77c1a7ce, org.springframework.security.web.authentication.logout.LogoutFilter@7f93fce1, tech.robd.jwt.filter.JwtAuthenticationFilter@68aec50, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@26edfa34, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5ac8916d, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@7375ebe7, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@8b93c88, org.springframework.security.web.access.ExceptionTranslationFilter@7444714e, org.springframework.security.web.access.intercept.AuthorizationFilter@5ce7ab6f]
2025-03-19 14:34:12 INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-03-19 14:34:12 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8081 (http) with context path ''
2025-03-19 14:34:12 INFO  tech.robd.jwt.JwtAuthApplication - Started JwtAuthApplication in 8.509 seconds (process running for 10.122)
2025-03-19 14:35:24 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 14:35:24 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-03-19 14:35:24 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-03-19 14:46:04 INFO  t.r.j.i.AuthenticationIntegrationTest - Starting AuthenticationIntegrationTest using Java 21.0.3 with PID 25568 (started by robde in C:\data\work\myframework\simple-spring-jwt-auth)
2025-03-19 14:46:04 DEBUG t.r.j.i.AuthenticationIntegrationTest - Running with Spring Boot v3.1.2, Spring v6.0.11
2025-03-19 14:46:04 INFO  t.r.j.i.AuthenticationIntegrationTest - The following 1 profile is active: "test"
2025-03-19 14:46:05 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-19 14:46:05 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 89 ms. Found 3 JPA repository interfaces.
2025-03-19 14:46:06 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-03-19 14:46:06 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:8b7af83b-6bf6-45fc-8d02-3781bb86256b user=SA
2025-03-19 14:46:06 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-03-19 14:46:06 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-19 14:46:06 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.2.6.Final
2025-03-19 14:46:06 INFO  org.hibernate.cfg.Environment - HHH000406: Using bytecode reflection optimizer
2025-03-19 14:46:06 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 14:46:07 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-19 14:46:07 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 14:46:08 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-03-19 14:46:08 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 14:46:08 ERROR t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST ERROR LOG - Should appear in console
2025-03-19 14:46:08 WARN  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST WARNING LOG - Should appear in console
2025-03-19 14:46:08 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST INFO LOG - Should appear in console
2025-03-19 14:46:08 DEBUG t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST DEBUG LOG - May or may not appear depending on level
2025-03-19 14:46:08 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST SECURITY LOG - Should appear in security log
2025-03-19 14:46:08 INFO  tech.robd.jwt.util.JwtTokenUtil - JWT secret key loaded from file successfully
2025-03-19 14:46:09 INFO  t.r.jwt.service.DatabaseInitService - Initializing database with domains, roles and users from configuration
2025-03-19 14:46:09 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "41f5b" for domain: app1
2025-03-19 14:46:09 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: app1
2025-03-19 14:46:09 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "8587a" for domain: default
2025-03-19 14:46:09 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: default
2025-03-19 14:46:09 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 14:46:09 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 14:46:09 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 14:46:09 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 14:46:09 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 14:46:09 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 14:46:09 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "41f5b" for user admin1 in domain: app1
2025-03-19 14:46:09 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user admin1 in domain app1: ADMIN
2025-03-19 14:46:09 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: admin1 in domain: app1
2025-03-19 14:46:09 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "41f5b" for user user1 in domain: app1
2025-03-19 14:46:09 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user1 in domain app1: USER
2025-03-19 14:46:09 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user1 in domain: app1
2025-03-19 14:46:09 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "41f5b" for user user2 in domain: app1
2025-03-19 14:46:10 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user2 in domain app1: USER
2025-03-19 14:46:10 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user2 in domain: app1
2025-03-19 14:46:10 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "41f5b" for user user3 in domain: app1
2025-03-19 14:46:10 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user3 in domain app1: USER
2025-03-19 14:46:10 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user3 in domain: app1
2025-03-19 14:46:10 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "41f5b" for user manager1 in domain: app1
2025-03-19 14:46:10 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: MANAGER
2025-03-19 14:46:10 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: USER
2025-03-19 14:46:10 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: manager1 in domain: app1
2025-03-19 14:46:10 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-03-19 14:46:10 WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 35fe38ad-b649-42d4-a12b-cecbfb4708a7

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-03-19 14:46:10 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@5982255e, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7306836f, org.springframework.security.web.context.SecurityContextHolderFilter@736af6f3, org.springframework.security.web.header.HeaderWriterFilter@32be672d, org.springframework.security.web.authentication.logout.LogoutFilter@26247027, tech.robd.jwt.filter.JwtAuthenticationFilter@b1f36e5, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@3eb29382, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@3b24fb6f, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@6ec9f664, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@e9c5db9, org.springframework.security.web.access.ExceptionTranslationFilter@35e63d26, org.springframework.security.web.access.intercept.AuthorizationFilter@4d6fa22c]
2025-03-19 14:46:11 INFO  o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-03-19 14:46:11 INFO  o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-03-19 14:46:11 INFO  o.s.t.w.s.TestDispatcherServlet - Completed initialization in 2 ms
2025-03-19 14:46:11 INFO  t.r.j.i.AuthenticationIntegrationTest - Started AuthenticationIntegrationTest in 8.448 seconds (process running for 10.532)
2025-03-19 14:46:12 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 14:46:12 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 14:46:12 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 14:46:12 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 14:46:12 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 14:46:13 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 14:46:13 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 14:46:13 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 14:46:13 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/user/profile
2025-03-19 14:46:13 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 14:46:13 DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/user/profile
2025-03-19 14:46:13 WARN  o.s.web.servlet.PageNotFound - No mapping for GET /api/user/profile
2025-03-19 14:46:13 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 14:46:13 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 14:46:13 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 14:46:13 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 14:46:13 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 14:46:13 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 14:46:13 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 14:46:13 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 14:46:13 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/admin/users
2025-03-19 14:46:13 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 14:46:13 DEBUG o.s.s.w.a.AccessDeniedHandlerImpl - Responding with 403 status code
2025-03-19 14:46:13 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/user/profile
2025-03-19 14:46:13 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 14:46:13 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 14:46:13 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost/api/user/profile?continue to session
2025-03-19 14:46:13 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 14:46:13 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@544502d6
2025-03-19 14:46:13 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 14:46:13 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 14:46:13 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 14:46:13 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 14:46:13 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 14:46:13 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 14:46:13 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 14:46:13 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 14:46:14 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 14:46:14 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 14:46:14 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 14:46:14 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 14:46:14 WARN  t.robd.jwt.controller.AuthController - Authentication failed: username or domain is missing
2025-03-19 14:46:14 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 14:46:14 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 14:46:14 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 14:46:14 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 14:46:14 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: nonexistentuser
2025-03-19 14:46:14 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: nonexistentuser
2025-03-19 14:46:14 WARN  tech.robd.jwt.service.UserService - User not found: nonexistentuser
2025-03-19 14:46:14 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 14:46:14 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/user/profile
2025-03-19 14:46:14 ERROR tech.robd.jwt.util.JwtTokenUtil - JWT token validation error
io.jsonwebtoken.MalformedJwtException: JWT strings must contain exactly 2 period characters. Found: 0
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:275)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at tech.robd.jwt.util.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:125)
	at tech.robd.jwt.util.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:117)
	at tech.robd.jwt.util.JwtTokenUtil.getExpirationDateFromToken(JwtTokenUtil.java:113)
	at tech.robd.jwt.util.JwtTokenUtil.isTokenExpired(JwtTokenUtil.java:139)
	at tech.robd.jwt.util.JwtTokenUtil.validateToken(JwtTokenUtil.java:131)
	at tech.robd.jwt.filter.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:43)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at tech.robd.jwt.integration.AuthenticationIntegrationTest.testProtectedEndpointWithInvalidToken(AuthenticationIntegrationTest.java:190)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:727)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.processAllTestClasses(JUnitPlatformTestClassProcessor.java:124)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.access$000(JUnitPlatformTestClassProcessor.java:99)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor.stop(JUnitPlatformTestClassProcessor.java:94)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.stop(SuiteTestClassProcessor.java:63)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:92)
	at jdk.proxy1/jdk.proxy1.$Proxy4.stop(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker$3.run(TestWorker.java:200)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:132)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:103)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:63)
	at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:121)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)
2025-03-19 14:46:14 WARN  t.r.j.filter.JwtAuthenticationFilter - Invalid JWT token provided
2025-03-19 14:46:14 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 14:46:14 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost/api/user/profile?continue to session
2025-03-19 14:46:14 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 14:46:14 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@544502d6
2025-03-19 14:46:14 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 14:46:14 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 14:46:14 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 14:46:14 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 14:46:14 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 14:46:14 WARN  tech.robd.jwt.service.UserService - Invalid password for user: testuser
2025-03-19 14:46:14 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 14:46:14 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 14:46:14 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-03-19 14:46:14 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-03-19 14:46:39 INFO  t.r.j.i.AuthenticationIntegrationTest - Starting AuthenticationIntegrationTest using Java 21.0.3 with PID 3536 (started by robde in C:\data\work\myframework\simple-spring-jwt-auth)
2025-03-19 14:46:39 DEBUG t.r.j.i.AuthenticationIntegrationTest - Running with Spring Boot v3.1.2, Spring v6.0.11
2025-03-19 14:46:39 INFO  t.r.j.i.AuthenticationIntegrationTest - The following 1 profile is active: "test"
2025-03-19 14:46:40 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-19 14:46:40 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 102 ms. Found 3 JPA repository interfaces.
2025-03-19 14:46:41 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-03-19 14:46:41 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:7f79eb43-9beb-43a2-9a0c-545244d7f544 user=SA
2025-03-19 14:46:41 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-03-19 14:46:41 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-19 14:46:41 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.2.6.Final
2025-03-19 14:46:41 INFO  org.hibernate.cfg.Environment - HHH000406: Using bytecode reflection optimizer
2025-03-19 14:46:42 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 14:46:42 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-19 14:46:42 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 14:46:43 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-03-19 14:46:43 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 14:46:43 ERROR t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST ERROR LOG - Should appear in console
2025-03-19 14:46:43 WARN  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST WARNING LOG - Should appear in console
2025-03-19 14:46:43 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST INFO LOG - Should appear in console
2025-03-19 14:46:43 DEBUG t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST DEBUG LOG - May or may not appear depending on level
2025-03-19 14:46:43 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST SECURITY LOG - Should appear in security log
2025-03-19 14:46:43 INFO  tech.robd.jwt.util.JwtTokenUtil - JWT secret key loaded from file successfully
2025-03-19 14:46:44 INFO  t.r.jwt.service.DatabaseInitService - Initializing database with domains, roles and users from configuration
2025-03-19 14:46:44 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "9a0ff" for domain: app1
2025-03-19 14:46:45 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: app1
2025-03-19 14:46:45 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "42912" for domain: default
2025-03-19 14:46:45 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: default
2025-03-19 14:46:45 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 14:46:45 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 14:46:45 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 14:46:45 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 14:46:45 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 14:46:45 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 14:46:45 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "9a0ff" for user admin1 in domain: app1
2025-03-19 14:46:45 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user admin1 in domain app1: ADMIN
2025-03-19 14:46:45 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: admin1 in domain: app1
2025-03-19 14:46:45 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "9a0ff" for user user1 in domain: app1
2025-03-19 14:46:45 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user1 in domain app1: USER
2025-03-19 14:46:45 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user1 in domain: app1
2025-03-19 14:46:45 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "9a0ff" for user user2 in domain: app1
2025-03-19 14:46:45 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user2 in domain app1: USER
2025-03-19 14:46:45 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user2 in domain: app1
2025-03-19 14:46:45 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "9a0ff" for user user3 in domain: app1
2025-03-19 14:46:45 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user3 in domain app1: USER
2025-03-19 14:46:45 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user3 in domain: app1
2025-03-19 14:46:45 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "9a0ff" for user manager1 in domain: app1
2025-03-19 14:46:45 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: MANAGER
2025-03-19 14:46:45 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: USER
2025-03-19 14:46:45 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: manager1 in domain: app1
2025-03-19 14:46:45 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-03-19 14:46:46 WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 3251088f-4892-43ae-b799-3098023ee99d

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-03-19 14:46:46 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@236bb278, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7200702, org.springframework.security.web.context.SecurityContextHolderFilter@35e63d26, org.springframework.security.web.header.HeaderWriterFilter@b3c7c75, org.springframework.security.web.authentication.logout.LogoutFilter@77228160, tech.robd.jwt.filter.JwtAuthenticationFilter@530a46f4, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@4c5d1649, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@32be672d, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@23e54c8a, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@3eb29382, org.springframework.security.web.access.ExceptionTranslationFilter@5a919251, org.springframework.security.web.access.intercept.AuthorizationFilter@320ca97c]
2025-03-19 14:46:47 INFO  o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-03-19 14:46:47 INFO  o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-03-19 14:46:47 INFO  o.s.t.w.s.TestDispatcherServlet - Completed initialization in 2 ms
2025-03-19 14:46:47 INFO  t.r.j.i.AuthenticationIntegrationTest - Started AuthenticationIntegrationTest in 9.02 seconds (process running for 11.07)
2025-03-19 14:46:48 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 14:46:48 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 14:46:48 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 14:46:48 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 14:46:48 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 14:46:48 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 14:46:48 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 14:46:48 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 14:46:48 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/user/profile
2025-03-19 14:46:48 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 14:46:48 DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/user/profile
2025-03-19 14:46:48 WARN  o.s.web.servlet.PageNotFound - No mapping for GET /api/user/profile
2025-03-19 14:46:49 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 14:46:49 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 14:46:49 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 14:46:49 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 14:46:49 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 14:46:49 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 14:46:49 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 14:46:49 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 14:46:49 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/admin/users
2025-03-19 14:46:49 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 14:46:49 DEBUG o.s.s.w.a.AccessDeniedHandlerImpl - Responding with 403 status code
2025-03-19 14:46:49 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/user/profile
2025-03-19 14:46:49 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 14:46:49 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 14:46:49 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost/api/user/profile?continue to session
2025-03-19 14:46:49 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 14:46:49 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@648100de
2025-03-19 14:46:49 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 14:46:49 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 14:46:49 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 14:46:49 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 14:46:49 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 14:46:49 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 14:46:49 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 14:46:49 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 14:46:49 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 14:46:49 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 14:46:49 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 14:46:49 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 14:46:49 WARN  t.robd.jwt.controller.AuthController - Authentication failed: username or domain is missing
2025-03-19 14:46:49 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 14:46:50 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 14:46:50 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 14:46:50 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 14:46:50 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: nonexistentuser
2025-03-19 14:46:50 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: nonexistentuser
2025-03-19 14:46:50 WARN  tech.robd.jwt.service.UserService - User not found: nonexistentuser
2025-03-19 14:46:50 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 14:46:50 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/user/profile
2025-03-19 14:46:50 ERROR tech.robd.jwt.util.JwtTokenUtil - JWT token validation error
io.jsonwebtoken.MalformedJwtException: JWT strings must contain exactly 2 period characters. Found: 0
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:275)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at tech.robd.jwt.util.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:125)
	at tech.robd.jwt.util.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:117)
	at tech.robd.jwt.util.JwtTokenUtil.getExpirationDateFromToken(JwtTokenUtil.java:113)
	at tech.robd.jwt.util.JwtTokenUtil.isTokenExpired(JwtTokenUtil.java:139)
	at tech.robd.jwt.util.JwtTokenUtil.validateToken(JwtTokenUtil.java:131)
	at tech.robd.jwt.filter.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:43)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at tech.robd.jwt.integration.AuthenticationIntegrationTest.testProtectedEndpointWithInvalidToken(AuthenticationIntegrationTest.java:190)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:727)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.processAllTestClasses(JUnitPlatformTestClassProcessor.java:124)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.access$000(JUnitPlatformTestClassProcessor.java:99)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor.stop(JUnitPlatformTestClassProcessor.java:94)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.stop(SuiteTestClassProcessor.java:63)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:92)
	at jdk.proxy1/jdk.proxy1.$Proxy4.stop(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker$3.run(TestWorker.java:200)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:132)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:103)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:63)
	at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:121)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)
2025-03-19 14:46:50 WARN  t.r.j.filter.JwtAuthenticationFilter - Invalid JWT token provided
2025-03-19 14:46:50 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 14:46:50 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost/api/user/profile?continue to session
2025-03-19 14:46:50 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 14:46:50 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@648100de
2025-03-19 14:46:50 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 14:46:50 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 14:46:50 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 14:46:50 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 14:46:50 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 14:46:50 WARN  tech.robd.jwt.service.UserService - Invalid password for user: testuser
2025-03-19 14:46:50 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 14:46:50 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 14:46:50 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-03-19 14:46:50 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-03-19 14:48:40 INFO  t.r.j.i.AuthenticationIntegrationTest - Starting AuthenticationIntegrationTest using Java 21.0.3 with PID 33148 (started by robde in C:\data\work\myframework\simple-spring-jwt-auth)
2025-03-19 14:48:40 DEBUG t.r.j.i.AuthenticationIntegrationTest - Running with Spring Boot v3.1.2, Spring v6.0.11
2025-03-19 14:48:40 INFO  t.r.j.i.AuthenticationIntegrationTest - The following 1 profile is active: "test"
2025-03-19 14:48:41 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-19 14:48:41 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 87 ms. Found 3 JPA repository interfaces.
2025-03-19 14:48:42 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-03-19 14:48:43 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:5ea786e9-4619-4002-a02c-12350f674720 user=SA
2025-03-19 14:48:43 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-03-19 14:48:43 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-19 14:48:43 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.2.6.Final
2025-03-19 14:48:43 INFO  org.hibernate.cfg.Environment - HHH000406: Using bytecode reflection optimizer
2025-03-19 14:48:44 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 14:48:44 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-19 14:48:45 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 14:48:46 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-03-19 14:48:46 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 14:48:46 ERROR t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST ERROR LOG - Should appear in console
2025-03-19 14:48:46 WARN  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST WARNING LOG - Should appear in console
2025-03-19 14:48:46 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST INFO LOG - Should appear in console
2025-03-19 14:48:46 DEBUG t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST DEBUG LOG - May or may not appear depending on level
2025-03-19 14:48:46 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST SECURITY LOG - Should appear in security log
2025-03-19 14:48:46 INFO  tech.robd.jwt.util.JwtTokenUtil - JWT secret key loaded from file successfully
2025-03-19 14:48:48 INFO  t.r.jwt.service.DatabaseInitService - Initializing database with domains, roles and users from configuration
2025-03-19 14:48:49 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "98a7a" for domain: app1
2025-03-19 14:48:49 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: app1
2025-03-19 14:48:49 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "ba087" for domain: default
2025-03-19 14:48:49 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: default
2025-03-19 14:48:49 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 14:48:49 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 14:48:49 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 14:48:49 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 14:48:49 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 14:48:49 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 14:48:49 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "98a7a" for user admin1 in domain: app1
2025-03-19 14:48:49 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user admin1 in domain app1: ADMIN
2025-03-19 14:48:49 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: admin1 in domain: app1
2025-03-19 14:48:49 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "98a7a" for user user1 in domain: app1
2025-03-19 14:48:49 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user1 in domain app1: USER
2025-03-19 14:48:49 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user1 in domain: app1
2025-03-19 14:48:49 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "98a7a" for user user2 in domain: app1
2025-03-19 14:48:49 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user2 in domain app1: USER
2025-03-19 14:48:49 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user2 in domain: app1
2025-03-19 14:48:49 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "98a7a" for user user3 in domain: app1
2025-03-19 14:48:49 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user3 in domain app1: USER
2025-03-19 14:48:50 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user3 in domain: app1
2025-03-19 14:48:50 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "98a7a" for user manager1 in domain: app1
2025-03-19 14:48:50 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: MANAGER
2025-03-19 14:48:50 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: USER
2025-03-19 14:48:50 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: manager1 in domain: app1
2025-03-19 14:48:50 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-03-19 14:48:50 WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: a660b645-b359-4cf4-922b-ead2a64a8c82

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-03-19 14:48:51 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@31e5d408, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@7aaf0f0a, org.springframework.security.web.context.SecurityContextHolderFilter@6421d85c, org.springframework.security.web.header.HeaderWriterFilter@4a5e0faf, org.springframework.security.web.authentication.logout.LogoutFilter@475c2f47, tech.robd.jwt.filter.JwtAuthenticationFilter@6dc5e857, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@59e24c62, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@16b1b213, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@77f1026e, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@638b05fb, org.springframework.security.web.access.ExceptionTranslationFilter@361b2995, org.springframework.security.web.access.intercept.AuthorizationFilter@3eb29382]
2025-03-19 14:48:54 INFO  o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-03-19 14:48:54 INFO  o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-03-19 14:48:54 INFO  o.s.t.w.s.TestDispatcherServlet - Completed initialization in 1 ms
2025-03-19 14:48:55 INFO  t.r.j.i.AuthenticationIntegrationTest - Started AuthenticationIntegrationTest in 14.753 seconds (process running for 17.493)
2025-03-19 14:48:58 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/user/profile
2025-03-19 14:48:58 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 14:48:58 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 14:48:58 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost/api/user/profile?continue to session
2025-03-19 14:48:58 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 14:48:58 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@1476e447
2025-03-19 14:48:58 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 14:48:58 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-03-19 14:48:58 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-03-19 14:49:08 INFO  t.r.j.i.AuthenticationIntegrationTest - Starting AuthenticationIntegrationTest using Java 21.0.3 with PID 11704 (started by robde in C:\data\work\myframework\simple-spring-jwt-auth)
2025-03-19 14:49:08 DEBUG t.r.j.i.AuthenticationIntegrationTest - Running with Spring Boot v3.1.2, Spring v6.0.11
2025-03-19 14:49:08 INFO  t.r.j.i.AuthenticationIntegrationTest - The following 1 profile is active: "test"
2025-03-19 14:49:09 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-19 14:49:10 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 96 ms. Found 3 JPA repository interfaces.
2025-03-19 14:49:10 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-03-19 14:49:11 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:30356942-d530-4fee-bed6-60a57efb2f8d user=SA
2025-03-19 14:49:11 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-03-19 14:49:11 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-19 14:49:11 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.2.6.Final
2025-03-19 14:49:11 INFO  org.hibernate.cfg.Environment - HHH000406: Using bytecode reflection optimizer
2025-03-19 14:49:11 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 14:49:11 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-19 14:49:12 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 14:49:13 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-03-19 14:49:13 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 14:49:13 ERROR t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST ERROR LOG - Should appear in console
2025-03-19 14:49:13 WARN  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST WARNING LOG - Should appear in console
2025-03-19 14:49:13 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST INFO LOG - Should appear in console
2025-03-19 14:49:13 DEBUG t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST DEBUG LOG - May or may not appear depending on level
2025-03-19 14:49:13 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST SECURITY LOG - Should appear in security log
2025-03-19 14:49:13 INFO  tech.robd.jwt.util.JwtTokenUtil - JWT secret key loaded from file successfully
2025-03-19 14:49:13 INFO  t.r.jwt.service.DatabaseInitService - Initializing database with domains, roles and users from configuration
2025-03-19 14:49:14 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "dcc40" for domain: app1
2025-03-19 14:49:14 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: app1
2025-03-19 14:49:14 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "112ae" for domain: default
2025-03-19 14:49:14 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: default
2025-03-19 14:49:14 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 14:49:14 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 14:49:14 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 14:49:14 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 14:49:14 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 14:49:14 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 14:49:14 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "dcc40" for user admin1 in domain: app1
2025-03-19 14:49:14 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user admin1 in domain app1: ADMIN
2025-03-19 14:49:14 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: admin1 in domain: app1
2025-03-19 14:49:14 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "dcc40" for user user1 in domain: app1
2025-03-19 14:49:14 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user1 in domain app1: USER
2025-03-19 14:49:14 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user1 in domain: app1
2025-03-19 14:49:14 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "dcc40" for user user2 in domain: app1
2025-03-19 14:49:14 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user2 in domain app1: USER
2025-03-19 14:49:14 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user2 in domain: app1
2025-03-19 14:49:14 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "dcc40" for user user3 in domain: app1
2025-03-19 14:49:14 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user3 in domain app1: USER
2025-03-19 14:49:14 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user3 in domain: app1
2025-03-19 14:49:14 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "dcc40" for user manager1 in domain: app1
2025-03-19 14:49:14 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: MANAGER
2025-03-19 14:49:14 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: USER
2025-03-19 14:49:14 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: manager1 in domain: app1
2025-03-19 14:49:14 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-03-19 14:49:15 WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 61e03657-030a-4153-aeb5-9a488d9ce95d

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-03-19 14:49:15 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@77e42cbf, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@68bef3df, org.springframework.security.web.context.SecurityContextHolderFilter@77f1026e, org.springframework.security.web.header.HeaderWriterFilter@6421d85c, org.springframework.security.web.authentication.logout.LogoutFilter@1695f7cb, tech.robd.jwt.filter.JwtAuthenticationFilter@6dc5e857, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@31e5d408, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@75a6cdb, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@1ce07709, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@6aeb769d, org.springframework.security.web.access.ExceptionTranslationFilter@680408ac, org.springframework.security.web.access.intercept.AuthorizationFilter@5982255e]
2025-03-19 14:49:16 INFO  o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-03-19 14:49:16 INFO  o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-03-19 14:49:16 INFO  o.s.t.w.s.TestDispatcherServlet - Completed initialization in 4 ms
2025-03-19 14:49:16 INFO  t.r.j.i.AuthenticationIntegrationTest - Started AuthenticationIntegrationTest in 8.194 seconds (process running for 10.081)
2025-03-19 14:49:17 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/user/profile
2025-03-19 14:49:17 ERROR tech.robd.jwt.util.JwtTokenUtil - JWT token validation error
io.jsonwebtoken.MalformedJwtException: JWT strings must contain exactly 2 period characters. Found: 0
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:275)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at tech.robd.jwt.util.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:125)
	at tech.robd.jwt.util.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:117)
	at tech.robd.jwt.util.JwtTokenUtil.getExpirationDateFromToken(JwtTokenUtil.java:113)
	at tech.robd.jwt.util.JwtTokenUtil.isTokenExpired(JwtTokenUtil.java:139)
	at tech.robd.jwt.util.JwtTokenUtil.validateToken(JwtTokenUtil.java:131)
	at tech.robd.jwt.filter.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:43)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at tech.robd.jwt.integration.AuthenticationIntegrationTest.testProtectedEndpointWithInvalidToken(AuthenticationIntegrationTest.java:190)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:727)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.processAllTestClasses(JUnitPlatformTestClassProcessor.java:124)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.access$000(JUnitPlatformTestClassProcessor.java:99)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor.stop(JUnitPlatformTestClassProcessor.java:94)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.stop(SuiteTestClassProcessor.java:63)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:92)
	at jdk.proxy1/jdk.proxy1.$Proxy4.stop(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker$3.run(TestWorker.java:200)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:132)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:103)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:63)
	at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:121)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)
2025-03-19 14:49:17 WARN  t.r.j.filter.JwtAuthenticationFilter - Invalid JWT token provided
2025-03-19 14:49:17 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 14:49:17 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost/api/user/profile?continue to session
2025-03-19 14:49:17 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 14:49:17 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@282831ea
2025-03-19 14:49:17 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 14:49:17 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-03-19 14:49:17 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-03-19 15:33:21 INFO  tech.robd.jwt.util.JwtTokenUtilTest - Starting JwtTokenUtilTest using Java 21.0.3 with PID 35368 (started by robde in C:\data\work\myframework\simple-spring-jwt-auth)
2025-03-19 15:33:21 DEBUG tech.robd.jwt.util.JwtTokenUtilTest - Running with Spring Boot v3.1.2, Spring v6.0.11
2025-03-19 15:33:21 INFO  tech.robd.jwt.util.JwtTokenUtilTest - The following 1 profile is active: "test"
2025-03-19 15:33:22 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-19 15:33:22 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 95 ms. Found 3 JPA repository interfaces.
2025-03-19 15:33:23 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-03-19 15:33:23 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:6435734a-2f35-4305-9db8-0a4596817d11 user=SA
2025-03-19 15:33:23 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-03-19 15:33:23 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-19 15:33:23 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.2.6.Final
2025-03-19 15:33:23 INFO  org.hibernate.cfg.Environment - HHH000406: Using bytecode reflection optimizer
2025-03-19 15:33:24 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 15:33:24 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-19 15:33:24 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 15:33:25 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-03-19 15:33:25 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 15:33:25 ERROR t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST ERROR LOG - Should appear in console
2025-03-19 15:33:25 WARN  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST WARNING LOG - Should appear in console
2025-03-19 15:33:25 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST INFO LOG - Should appear in console
2025-03-19 15:33:25 DEBUG t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST DEBUG LOG - May or may not appear depending on level
2025-03-19 15:33:25 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST SECURITY LOG - Should appear in security log
2025-03-19 15:33:25 INFO  tech.robd.jwt.util.JwtTokenUtil - JWT secret key loaded from file successfully
2025-03-19 15:33:26 INFO  t.r.jwt.service.DatabaseInitService - Initializing database with domains, roles and users from configuration
2025-03-19 15:33:27 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "f08ac" for domain: app1
2025-03-19 15:33:27 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: app1
2025-03-19 15:33:27 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "b1b9e" for domain: default
2025-03-19 15:33:27 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: default
2025-03-19 15:33:27 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 15:33:27 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 15:33:27 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 15:33:27 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 15:33:27 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 15:33:27 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 15:33:27 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "f08ac" for user admin1 in domain: app1
2025-03-19 15:33:27 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user admin1 in domain app1: ADMIN
2025-03-19 15:33:27 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: admin1 in domain: app1
2025-03-19 15:33:27 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "f08ac" for user user1 in domain: app1
2025-03-19 15:33:27 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user1 in domain app1: USER
2025-03-19 15:33:27 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user1 in domain: app1
2025-03-19 15:33:27 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "f08ac" for user user2 in domain: app1
2025-03-19 15:33:27 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user2 in domain app1: USER
2025-03-19 15:33:27 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user2 in domain: app1
2025-03-19 15:33:27 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "f08ac" for user user3 in domain: app1
2025-03-19 15:33:27 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user3 in domain app1: USER
2025-03-19 15:33:27 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user3 in domain: app1
2025-03-19 15:33:27 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "f08ac" for user manager1 in domain: app1
2025-03-19 15:33:27 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: MANAGER
2025-03-19 15:33:27 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: USER
2025-03-19 15:33:27 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: manager1 in domain: app1
2025-03-19 15:33:27 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-03-19 15:33:28 WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 37e6fcfd-4a9e-4976-b018-76fe6ebc3ceb

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-03-19 15:33:28 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@7dbc77ca, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@4c25687b, org.springframework.security.web.context.SecurityContextHolderFilter@2297c8bf, org.springframework.security.web.header.HeaderWriterFilter@3fc105dd, org.springframework.security.web.authentication.logout.LogoutFilter@65630116, tech.robd.jwt.filter.JwtAuthenticationFilter@356ab368, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@7be9582e, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@34a06981, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@458500d1, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@5c21b22e, org.springframework.security.web.access.ExceptionTranslationFilter@5529fd4e, org.springframework.security.web.access.intercept.AuthorizationFilter@365291bd]
2025-03-19 15:33:29 INFO  tech.robd.jwt.util.JwtTokenUtilTest - Started JwtTokenUtilTest in 8.952 seconds (process running for 10.889)
2025-03-19 15:33:30 ERROR tech.robd.jwt.util.JwtTokenUtil - JWT token validation error
io.jsonwebtoken.MalformedJwtException: Malformed JWT JSON: �{ږ'
	at io.jsonwebtoken.impl.JwtDeserializer.deserialize(JwtDeserializer.java:49)
	at io.jsonwebtoken.impl.DefaultJwtParser.readValue(DefaultJwtParser.java:600)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:290)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at tech.robd.jwt.util.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:125)
	at tech.robd.jwt.util.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:117)
	at tech.robd.jwt.util.JwtTokenUtil.getExpirationDateFromToken(JwtTokenUtil.java:113)
	at tech.robd.jwt.util.JwtTokenUtil.isTokenExpired(JwtTokenUtil.java:139)
	at tech.robd.jwt.util.JwtTokenUtil.validateToken(JwtTokenUtil.java:131)
	at tech.robd.jwt.util.JwtTokenUtilTest.testInvalidToken(JwtTokenUtilTest.java:61)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:727)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.processAllTestClasses(JUnitPlatformTestClassProcessor.java:124)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.access$000(JUnitPlatformTestClassProcessor.java:99)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor.stop(JUnitPlatformTestClassProcessor.java:94)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.stop(SuiteTestClassProcessor.java:63)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:92)
	at jdk.proxy1/jdk.proxy1.$Proxy4.stop(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker$3.run(TestWorker.java:200)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:132)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:103)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:63)
	at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:121)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)
Caused by: io.jsonwebtoken.io.DeserializationException: Unable to deserialize bytes into a java.lang.Object instance: Invalid UTF-8 start byte 0xbf
 at [Source: (byte[])"�{ږ'"; line: 1, column: 3]
	at io.jsonwebtoken.jackson.io.JacksonDeserializer.deserialize(JacksonDeserializer.java:99)
	at io.jsonwebtoken.impl.JwtDeserializer.deserialize(JwtDeserializer.java:47)
	... 91 common frames omitted
Caused by: com.fasterxml.jackson.core.JsonParseException: Invalid UTF-8 start byte 0xbf
 at [Source: (byte[])"�{ږ'"; line: 1, column: 3]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2477)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:750)
	at com.fasterxml.jackson.core.json.UTF8StreamJsonParser._reportInvalidInitial(UTF8StreamJsonParser.java:3712)
	at com.fasterxml.jackson.core.json.UTF8StreamJsonParser._decodeCharForError(UTF8StreamJsonParser.java:3456)
	at com.fasterxml.jackson.core.json.UTF8StreamJsonParser._reportInvalidToken(UTF8StreamJsonParser.java:3684)
	at com.fasterxml.jackson.core.json.UTF8StreamJsonParser._handleUnexpectedValue(UTF8StreamJsonParser.java:2787)
	at com.fasterxml.jackson.core.json.UTF8StreamJsonParser._nextTokenNotInObject(UTF8StreamJsonParser.java:908)
	at com.fasterxml.jackson.core.json.UTF8StreamJsonParser.nextToken(UTF8StreamJsonParser.java:794)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4912)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4818)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3833)
	at io.jsonwebtoken.jackson.io.JacksonDeserializer.readValue(JacksonDeserializer.java:104)
	at io.jsonwebtoken.jackson.io.JacksonDeserializer.deserialize(JacksonDeserializer.java:96)
	... 92 common frames omitted
2025-03-19 15:33:30 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 15:33:30 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-03-19 15:33:30 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-03-19 15:33:48 INFO  t.r.j.i.AuthenticationIntegrationTest - Starting AuthenticationIntegrationTest using Java 21.0.3 with PID 17704 (started by robde in C:\data\work\myframework\simple-spring-jwt-auth)
2025-03-19 15:33:48 DEBUG t.r.j.i.AuthenticationIntegrationTest - Running with Spring Boot v3.1.2, Spring v6.0.11
2025-03-19 15:33:48 INFO  t.r.j.i.AuthenticationIntegrationTest - The following 1 profile is active: "test"
2025-03-19 15:33:50 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-19 15:33:50 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 108 ms. Found 3 JPA repository interfaces.
2025-03-19 15:33:51 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-03-19 15:33:51 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:3bc59437-4fec-4e16-a7a1-7945206ec2eb user=SA
2025-03-19 15:33:51 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-03-19 15:33:51 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-19 15:33:51 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.2.6.Final
2025-03-19 15:33:51 INFO  org.hibernate.cfg.Environment - HHH000406: Using bytecode reflection optimizer
2025-03-19 15:33:52 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 15:33:52 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-19 15:33:52 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 15:33:53 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-03-19 15:33:53 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 15:33:53 ERROR t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST ERROR LOG - Should appear in console
2025-03-19 15:33:53 WARN  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST WARNING LOG - Should appear in console
2025-03-19 15:33:53 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST INFO LOG - Should appear in console
2025-03-19 15:33:53 DEBUG t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST DEBUG LOG - May or may not appear depending on level
2025-03-19 15:33:53 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST SECURITY LOG - Should appear in security log
2025-03-19 15:33:53 INFO  tech.robd.jwt.util.JwtTokenUtil - JWT secret key loaded from file successfully
2025-03-19 15:33:54 INFO  t.r.jwt.service.DatabaseInitService - Initializing database with domains, roles and users from configuration
2025-03-19 15:33:54 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "5036a" for domain: app1
2025-03-19 15:33:55 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: app1
2025-03-19 15:33:55 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "b58fe" for domain: default
2025-03-19 15:33:55 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: default
2025-03-19 15:33:55 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 15:33:55 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 15:33:55 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 15:33:55 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 15:33:55 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 15:33:55 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 15:33:55 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "5036a" for user admin1 in domain: app1
2025-03-19 15:33:55 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user admin1 in domain app1: ADMIN
2025-03-19 15:33:55 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: admin1 in domain: app1
2025-03-19 15:33:55 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "5036a" for user user1 in domain: app1
2025-03-19 15:33:55 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user1 in domain app1: USER
2025-03-19 15:33:55 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user1 in domain: app1
2025-03-19 15:33:55 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "5036a" for user user2 in domain: app1
2025-03-19 15:33:55 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user2 in domain app1: USER
2025-03-19 15:33:55 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user2 in domain: app1
2025-03-19 15:33:55 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "5036a" for user user3 in domain: app1
2025-03-19 15:33:55 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user3 in domain app1: USER
2025-03-19 15:33:55 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user3 in domain: app1
2025-03-19 15:33:55 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "5036a" for user manager1 in domain: app1
2025-03-19 15:33:55 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: MANAGER
2025-03-19 15:33:55 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: USER
2025-03-19 15:33:55 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: manager1 in domain: app1
2025-03-19 15:33:55 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-03-19 15:33:55 WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 5f37090c-44d2-4439-ad2c-d09924cb2d07

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-03-19 15:33:56 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@393aac93, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@71dac63f, org.springframework.security.web.context.SecurityContextHolderFilter@6ec9f664, org.springframework.security.web.header.HeaderWriterFilter@736af6f3, org.springframework.security.web.authentication.logout.LogoutFilter@3c592c0c, tech.robd.jwt.filter.JwtAuthenticationFilter@397f925e, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@5982255e, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@1b48784a, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@7ab17cf, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@36003e90, org.springframework.security.web.access.ExceptionTranslationFilter@23e54c8a, org.springframework.security.web.access.intercept.AuthorizationFilter@6d0fe80c]
2025-03-19 15:33:57 INFO  o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-03-19 15:33:57 INFO  o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-03-19 15:33:57 INFO  o.s.t.w.s.TestDispatcherServlet - Completed initialization in 2 ms
2025-03-19 15:33:57 INFO  t.r.j.i.AuthenticationIntegrationTest - Started AuthenticationIntegrationTest in 9.166 seconds (process running for 11.162)
2025-03-19 15:33:58 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 15:33:58 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 15:33:58 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 15:33:58 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 15:33:58 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 15:33:58 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 15:33:58 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 15:33:58 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 15:33:58 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/user/profile
2025-03-19 15:33:58 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 15:33:58 DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/user/profile
2025-03-19 15:33:58 WARN  o.s.web.servlet.PageNotFound - No mapping for GET /api/user/profile
2025-03-19 15:33:59 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 15:33:59 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 15:33:59 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 15:33:59 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 15:33:59 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 15:33:59 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 15:33:59 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 15:33:59 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 15:33:59 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/admin/users
2025-03-19 15:33:59 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 15:33:59 DEBUG o.s.s.w.a.AccessDeniedHandlerImpl - Responding with 403 status code
2025-03-19 15:33:59 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/user/profile
2025-03-19 15:33:59 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 15:33:59 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 15:33:59 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost/api/user/profile?continue to session
2025-03-19 15:33:59 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 15:33:59 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@544502d6
2025-03-19 15:33:59 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 15:33:59 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 15:33:59 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 15:33:59 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 15:33:59 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 15:33:59 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 15:33:59 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 15:33:59 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 15:33:59 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 15:33:59 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 15:33:59 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 15:33:59 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 15:33:59 WARN  t.robd.jwt.controller.AuthController - Authentication failed: username or domain is missing
2025-03-19 15:34:00 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 15:34:00 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 15:34:00 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 15:34:00 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 15:34:00 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: nonexistentuser
2025-03-19 15:34:00 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: nonexistentuser
2025-03-19 15:34:00 WARN  tech.robd.jwt.service.UserService - User not found: nonexistentuser
2025-03-19 15:34:00 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 15:34:00 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/user/profile
2025-03-19 15:34:00 ERROR tech.robd.jwt.util.JwtTokenUtil - JWT token validation error
io.jsonwebtoken.MalformedJwtException: JWT strings must contain exactly 2 period characters. Found: 0
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:275)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at tech.robd.jwt.util.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:125)
	at tech.robd.jwt.util.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:117)
	at tech.robd.jwt.util.JwtTokenUtil.getExpirationDateFromToken(JwtTokenUtil.java:113)
	at tech.robd.jwt.util.JwtTokenUtil.isTokenExpired(JwtTokenUtil.java:139)
	at tech.robd.jwt.util.JwtTokenUtil.validateToken(JwtTokenUtil.java:131)
	at tech.robd.jwt.filter.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:43)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at tech.robd.jwt.integration.AuthenticationIntegrationTest.testProtectedEndpointWithInvalidToken(AuthenticationIntegrationTest.java:190)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:727)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.processAllTestClasses(JUnitPlatformTestClassProcessor.java:124)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.access$000(JUnitPlatformTestClassProcessor.java:99)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor.stop(JUnitPlatformTestClassProcessor.java:94)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.stop(SuiteTestClassProcessor.java:63)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:92)
	at jdk.proxy1/jdk.proxy1.$Proxy4.stop(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker$3.run(TestWorker.java:200)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:132)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:103)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:63)
	at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:121)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)
2025-03-19 15:34:00 WARN  t.r.j.filter.JwtAuthenticationFilter - Invalid JWT token provided
2025-03-19 15:34:00 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 15:34:00 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost/api/user/profile?continue to session
2025-03-19 15:34:00 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 15:34:00 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@544502d6
2025-03-19 15:34:00 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 15:34:00 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 15:34:00 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 15:34:00 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 15:34:00 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 15:34:00 WARN  tech.robd.jwt.service.UserService - Invalid password for user: testuser
2025-03-19 15:34:00 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 15:34:00 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 15:34:00 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-03-19 15:34:00 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-03-19 15:43:27 INFO  t.r.j.i.AuthenticationIntegrationTest - Starting AuthenticationIntegrationTest using Java 21.0.3 with PID 7852 (started by robde in C:\data\work\myframework\simple-spring-jwt-auth)
2025-03-19 15:43:27 DEBUG t.r.j.i.AuthenticationIntegrationTest - Running with Spring Boot v3.1.2, Spring v6.0.11
2025-03-19 15:43:27 INFO  t.r.j.i.AuthenticationIntegrationTest - The following 1 profile is active: "test"
2025-03-19 15:43:28 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-19 15:43:28 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 79 ms. Found 3 JPA repository interfaces.
2025-03-19 15:43:29 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-03-19 15:43:30 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:962f4710-6574-4f74-9de6-fa6dcf240747 user=SA
2025-03-19 15:43:30 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-03-19 15:43:30 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-19 15:43:30 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.2.6.Final
2025-03-19 15:43:30 INFO  org.hibernate.cfg.Environment - HHH000406: Using bytecode reflection optimizer
2025-03-19 15:43:30 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 15:43:31 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-19 15:43:31 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 15:43:33 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-03-19 15:43:33 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 15:43:33 ERROR t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST ERROR LOG - Should appear in console
2025-03-19 15:43:33 WARN  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST WARNING LOG - Should appear in console
2025-03-19 15:43:33 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST INFO LOG - Should appear in console
2025-03-19 15:43:33 DEBUG t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST DEBUG LOG - May or may not appear depending on level
2025-03-19 15:43:33 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST SECURITY LOG - Should appear in security log
2025-03-19 15:43:33 INFO  tech.robd.jwt.util.JwtTokenUtil - JWT secret key loaded from file successfully
2025-03-19 15:43:34 INFO  t.r.jwt.service.DatabaseInitService - Initializing database with domains, roles and users from configuration
2025-03-19 15:43:35 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "6f5e2" for domain: app1
2025-03-19 15:43:35 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: app1
2025-03-19 15:43:35 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "692be" for domain: default
2025-03-19 15:43:35 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: default
2025-03-19 15:43:35 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 15:43:35 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 15:43:35 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 15:43:35 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 15:43:35 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 15:43:35 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 15:43:35 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "6f5e2" for user admin1 in domain: app1
2025-03-19 15:43:35 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user admin1 in domain app1: ADMIN
2025-03-19 15:43:35 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: admin1 in domain: app1
2025-03-19 15:43:35 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "6f5e2" for user user1 in domain: app1
2025-03-19 15:43:35 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user1 in domain app1: USER
2025-03-19 15:43:35 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user1 in domain: app1
2025-03-19 15:43:35 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "6f5e2" for user user2 in domain: app1
2025-03-19 15:43:36 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user2 in domain app1: USER
2025-03-19 15:43:36 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user2 in domain: app1
2025-03-19 15:43:36 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "6f5e2" for user user3 in domain: app1
2025-03-19 15:43:36 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user3 in domain app1: USER
2025-03-19 15:43:36 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user3 in domain: app1
2025-03-19 15:43:36 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "6f5e2" for user manager1 in domain: app1
2025-03-19 15:43:36 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: MANAGER
2025-03-19 15:43:36 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: USER
2025-03-19 15:43:36 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: manager1 in domain: app1
2025-03-19 15:43:36 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-03-19 15:43:36 WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 4ab138d6-2fb2-4540-8eec-ac35336b90ce

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-03-19 15:43:37 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@628af295, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@31c17fd4, org.springframework.security.web.context.SecurityContextHolderFilter@26247027, org.springframework.security.web.header.HeaderWriterFilter@522fc988, org.springframework.security.web.authentication.logout.LogoutFilter@744c16fb, tech.robd.jwt.filter.JwtAuthenticationFilter@18ab513d, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@7594d189, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@320ca97c, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@3c592c0c, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@60052518, org.springframework.security.web.access.ExceptionTranslationFilter@77228160, org.springframework.security.web.access.intercept.AuthorizationFilter@51f412e6]
2025-03-19 15:43:39 INFO  o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-03-19 15:43:39 INFO  o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-03-19 15:43:39 INFO  o.s.t.w.s.TestDispatcherServlet - Completed initialization in 2 ms
2025-03-19 15:43:39 INFO  t.r.j.i.AuthenticationIntegrationTest - Started AuthenticationIntegrationTest in 12.681 seconds (process running for 14.557)
2025-03-19 15:43:41 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 15:43:41 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 15:43:41 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 15:43:41 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 15:43:41 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 15:43:41 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 15:43:41 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 15:43:41 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 15:43:41 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/user/profile
2025-03-19 15:43:41 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 15:43:41 DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/user/profile
2025-03-19 15:43:41 WARN  o.s.web.servlet.PageNotFound - No mapping for GET /api/user/profile
2025-03-19 15:43:42 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 15:43:42 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 15:43:42 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 15:43:42 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 15:43:42 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 15:43:42 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 15:43:42 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 15:43:42 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 15:43:42 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/admin/users
2025-03-19 15:43:42 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 15:43:42 DEBUG o.s.s.w.a.AccessDeniedHandlerImpl - Responding with 403 status code
2025-03-19 15:43:42 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/user/profile
2025-03-19 15:43:42 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 15:43:42 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 15:43:42 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost/api/user/profile?continue to session
2025-03-19 15:43:42 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 15:43:42 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@6e56f5d4
2025-03-19 15:43:42 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 15:43:42 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 15:43:42 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 15:43:42 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 15:43:42 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 15:43:42 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 15:43:42 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 15:43:42 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 15:43:43 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 15:43:43 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 15:43:43 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 15:43:43 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 15:43:43 WARN  t.robd.jwt.controller.AuthController - Authentication failed: username or domain is missing
2025-03-19 15:43:43 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 15:43:43 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 15:43:43 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 15:43:43 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 15:43:43 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: nonexistentuser
2025-03-19 15:43:43 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: nonexistentuser
2025-03-19 15:43:43 WARN  tech.robd.jwt.service.UserService - User not found: nonexistentuser
2025-03-19 15:43:43 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 15:43:43 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/user/profile
2025-03-19 15:43:43 ERROR tech.robd.jwt.util.JwtTokenUtil - JWT token validation error
io.jsonwebtoken.MalformedJwtException: JWT strings must contain exactly 2 period characters. Found: 0
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:275)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at tech.robd.jwt.util.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:125)
	at tech.robd.jwt.util.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:117)
	at tech.robd.jwt.util.JwtTokenUtil.getExpirationDateFromToken(JwtTokenUtil.java:113)
	at tech.robd.jwt.util.JwtTokenUtil.isTokenExpired(JwtTokenUtil.java:139)
	at tech.robd.jwt.util.JwtTokenUtil.validateToken(JwtTokenUtil.java:131)
	at tech.robd.jwt.filter.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:43)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at tech.robd.jwt.integration.AuthenticationIntegrationTest.testProtectedEndpointWithInvalidToken(AuthenticationIntegrationTest.java:190)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:727)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.processAllTestClasses(JUnitPlatformTestClassProcessor.java:124)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.access$000(JUnitPlatformTestClassProcessor.java:99)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor.stop(JUnitPlatformTestClassProcessor.java:94)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.stop(SuiteTestClassProcessor.java:63)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:92)
	at jdk.proxy1/jdk.proxy1.$Proxy4.stop(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker$3.run(TestWorker.java:200)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:132)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:103)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:63)
	at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:121)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)
2025-03-19 15:43:43 WARN  t.r.j.filter.JwtAuthenticationFilter - Invalid JWT token provided
2025-03-19 15:43:43 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 15:43:43 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost/api/user/profile?continue to session
2025-03-19 15:43:43 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 15:43:43 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@6e56f5d4
2025-03-19 15:43:43 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 15:43:43 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 15:43:43 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 15:43:43 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 15:43:43 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 15:43:43 WARN  tech.robd.jwt.service.UserService - Invalid password for user: testuser
2025-03-19 15:43:43 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 15:43:43 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 15:43:43 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-03-19 15:43:43 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-03-19 15:52:01 INFO  t.r.j.i.AuthenticationIntegrationTest - Starting AuthenticationIntegrationTest using Java 21.0.3 with PID 25156 (started by robde in C:\data\work\myframework\simple-spring-jwt-auth)
2025-03-19 15:52:01 DEBUG t.r.j.i.AuthenticationIntegrationTest - Running with Spring Boot v3.1.2, Spring v6.0.11
2025-03-19 15:52:01 INFO  t.r.j.i.AuthenticationIntegrationTest - The following 1 profile is active: "test"
2025-03-19 15:52:02 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-19 15:52:02 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 96 ms. Found 3 JPA repository interfaces.
2025-03-19 15:52:04 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-03-19 15:52:05 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:48432caf-df73-487e-ad71-93891aa3865d user=SA
2025-03-19 15:52:05 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-03-19 15:52:05 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-19 15:52:05 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.2.6.Final
2025-03-19 15:52:05 INFO  org.hibernate.cfg.Environment - HHH000406: Using bytecode reflection optimizer
2025-03-19 15:52:06 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 15:52:06 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-19 15:52:07 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 15:52:09 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-03-19 15:52:09 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 15:52:09 ERROR t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST ERROR LOG - Should appear in console
2025-03-19 15:52:09 WARN  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST WARNING LOG - Should appear in console
2025-03-19 15:52:09 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST INFO LOG - Should appear in console
2025-03-19 15:52:09 DEBUG t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST DEBUG LOG - May or may not appear depending on level
2025-03-19 15:52:09 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST SECURITY LOG - Should appear in security log
2025-03-19 15:52:09 INFO  tech.robd.jwt.util.JwtTokenUtil - JWT secret key loaded from file successfully
2025-03-19 15:52:21 INFO  t.r.jwt.service.DatabaseInitService - Initializing database with domains, roles and users from configuration
2025-03-19 15:52:28 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "74691" for domain: app1
2025-03-19 15:52:28 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: app1
2025-03-19 15:52:28 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "72257" for domain: default
2025-03-19 15:52:28 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: default
2025-03-19 15:52:28 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 15:52:28 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 15:52:28 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 15:52:28 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 15:52:28 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 15:52:28 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 15:52:36 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "74691" for user admin1 in domain: app1
2025-03-19 15:52:36 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user admin1 in domain app1: ADMIN
2025-03-19 15:52:36 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: admin1 in domain: app1
2025-03-19 15:52:36 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "74691" for user user1 in domain: app1
2025-03-19 15:52:37 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user1 in domain app1: USER
2025-03-19 15:52:37 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user1 in domain: app1
2025-03-19 15:52:37 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "74691" for user user2 in domain: app1
2025-03-19 15:52:37 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user2 in domain app1: USER
2025-03-19 15:52:37 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user2 in domain: app1
2025-03-19 15:52:37 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "74691" for user user3 in domain: app1
2025-03-19 15:52:37 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user3 in domain app1: USER
2025-03-19 15:52:37 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user3 in domain: app1
2025-03-19 15:52:37 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "74691" for user manager1 in domain: app1
2025-03-19 15:52:37 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: MANAGER
2025-03-19 15:52:37 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: USER
2025-03-19 15:52:37 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: manager1 in domain: app1
2025-03-19 15:52:37 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-03-19 15:52:37 WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 5c91f9ec-f752-4f72-b8ba-b2b4a6d04cab

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-03-19 15:52:38 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@783a35d8, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@38821ada, org.springframework.security.web.context.SecurityContextHolderFilter@618d2191, org.springframework.security.web.header.HeaderWriterFilter@594793d1, org.springframework.security.web.authentication.logout.LogoutFilter@1bfc6e50, tech.robd.jwt.filter.JwtAuthenticationFilter@46baac0d, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@35fea0cd, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@57596d71, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@1c12f0f4, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@2ab40d2d, org.springframework.security.web.access.ExceptionTranslationFilter@4a571516, org.springframework.security.web.access.intercept.AuthorizationFilter@1bb21ec1]
2025-03-19 15:52:39 INFO  o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-03-19 15:52:39 INFO  o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-03-19 15:52:39 INFO  o.s.t.w.s.TestDispatcherServlet - Completed initialization in 2 ms
2025-03-19 15:52:39 INFO  t.r.j.i.AuthenticationIntegrationTest - Started AuthenticationIntegrationTest in 39.225 seconds (process running for 41.812)
2025-03-19 15:52:41 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 15:52:48 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 15:52:48 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 15:52:53 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 15:53:00 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 15:53:01 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 15:53:23 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 15:53:27 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 20:38:16 INFO  t.r.j.i.AuthenticationIntegrationTest - Starting AuthenticationIntegrationTest using Java 21.0.3 with PID 35424 (started by robde in C:\data\work\myframework\simple-spring-jwt-auth)
2025-03-19 20:38:16 DEBUG t.r.j.i.AuthenticationIntegrationTest - Running with Spring Boot v3.1.2, Spring v6.0.11
2025-03-19 20:38:16 INFO  t.r.j.i.AuthenticationIntegrationTest - The following 1 profile is active: "test"
2025-03-19 20:38:17 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-19 20:38:17 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 100 ms. Found 3 JPA repository interfaces.
2025-03-19 20:38:19 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-03-19 20:38:19 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:17bd526e-93fd-476d-a64a-78c78abd53cb user=SA
2025-03-19 20:38:19 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-03-19 20:38:19 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-19 20:38:19 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.2.6.Final
2025-03-19 20:38:19 INFO  org.hibernate.cfg.Environment - HHH000406: Using bytecode reflection optimizer
2025-03-19 20:38:19 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 20:38:20 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-19 20:38:20 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 20:38:21 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-03-19 20:38:21 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 20:38:21 ERROR t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST ERROR LOG - Should appear in console
2025-03-19 20:38:21 WARN  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST WARNING LOG - Should appear in console
2025-03-19 20:38:21 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST INFO LOG - Should appear in console
2025-03-19 20:38:21 DEBUG t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST DEBUG LOG - May or may not appear depending on level
2025-03-19 20:38:21 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST SECURITY LOG - Should appear in security log
2025-03-19 20:38:21 INFO  tech.robd.jwt.util.JwtTokenUtil - JWT secret key loaded from file successfully
2025-03-19 20:38:22 INFO  t.r.jwt.service.DatabaseInitService - Initializing database with domains, roles and users from configuration
2025-03-19 20:38:22 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "2077e" for domain: app1
2025-03-19 20:38:22 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: app1
2025-03-19 20:38:22 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "cf16f" for domain: default
2025-03-19 20:38:22 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: default
2025-03-19 20:38:22 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 20:38:22 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 20:38:22 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 20:38:22 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 20:38:22 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 20:38:22 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 20:38:22 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "2077e" for user admin1 in domain: app1
2025-03-19 20:38:22 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user admin1 in domain app1: ADMIN
2025-03-19 20:38:22 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: admin1 in domain: app1
2025-03-19 20:38:22 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "2077e" for user user1 in domain: app1
2025-03-19 20:38:22 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user1 in domain app1: USER
2025-03-19 20:38:22 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user1 in domain: app1
2025-03-19 20:38:22 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "2077e" for user user2 in domain: app1
2025-03-19 20:38:23 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user2 in domain app1: USER
2025-03-19 20:38:23 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user2 in domain: app1
2025-03-19 20:38:23 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "2077e" for user user3 in domain: app1
2025-03-19 20:38:23 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user3 in domain app1: USER
2025-03-19 20:38:23 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user3 in domain: app1
2025-03-19 20:38:23 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "2077e" for user manager1 in domain: app1
2025-03-19 20:38:23 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: MANAGER
2025-03-19 20:38:23 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: USER
2025-03-19 20:38:23 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: manager1 in domain: app1
2025-03-19 20:38:23 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-03-19 20:38:23 WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 26901aed-c286-4d25-8287-14cdc5e01dd2

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-03-19 20:38:23 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@4c32aa7e, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@c11ec9b, org.springframework.security.web.context.SecurityContextHolderFilter@5481001f, org.springframework.security.web.header.HeaderWriterFilter@4b094115, org.springframework.security.web.authentication.logout.LogoutFilter@45b37003, tech.robd.jwt.filter.JwtAuthenticationFilter@1512efe9, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@4ac1544f, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@475c2f47, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@10806dbe, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@fd8513b, org.springframework.security.web.access.ExceptionTranslationFilter@4d6fa22c, org.springframework.security.web.access.intercept.AuthorizationFilter@5ab0168]
2025-03-19 20:38:24 INFO  o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-03-19 20:38:24 INFO  o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-03-19 20:38:24 INFO  o.s.t.w.s.TestDispatcherServlet - Completed initialization in 3 ms
2025-03-19 20:38:24 INFO  t.r.j.i.AuthenticationIntegrationTest - Started AuthenticationIntegrationTest in 8.959 seconds (process running for 11.472)
2025-03-19 20:38:25 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 20:38:25 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 20:38:25 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 20:38:26 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 20:38:26 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 20:38:26 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 20:38:26 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 20:38:26 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 20:38:26 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/users
2025-03-19 20:38:26 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 20:38:26 DEBUG o.s.s.w.a.AccessDeniedHandlerImpl - Responding with 403 status code
2025-03-19 20:38:26 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 20:38:26 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-03-19 20:38:26 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-03-19 20:38:48 INFO  t.r.j.i.AuthenticationIntegrationTest - Starting AuthenticationIntegrationTest using Java 21.0.3 with PID 33364 (started by robde in C:\data\work\myframework\simple-spring-jwt-auth)
2025-03-19 20:38:48 DEBUG t.r.j.i.AuthenticationIntegrationTest - Running with Spring Boot v3.1.2, Spring v6.0.11
2025-03-19 20:38:48 INFO  t.r.j.i.AuthenticationIntegrationTest - The following 1 profile is active: "test"
2025-03-19 20:38:49 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-19 20:38:49 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 197 ms. Found 3 JPA repository interfaces.
2025-03-19 20:38:51 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-03-19 20:38:52 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:5852720f-8233-40cc-bdc7-19f5da8ffcaf user=SA
2025-03-19 20:38:52 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-03-19 20:38:52 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-19 20:38:52 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.2.6.Final
2025-03-19 20:38:52 INFO  org.hibernate.cfg.Environment - HHH000406: Using bytecode reflection optimizer
2025-03-19 20:38:52 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 20:38:53 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-19 20:38:54 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 20:38:56 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-03-19 20:38:56 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 20:38:56 ERROR t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST ERROR LOG - Should appear in console
2025-03-19 20:38:56 WARN  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST WARNING LOG - Should appear in console
2025-03-19 20:38:56 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST INFO LOG - Should appear in console
2025-03-19 20:38:56 DEBUG t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST DEBUG LOG - May or may not appear depending on level
2025-03-19 20:38:56 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST SECURITY LOG - Should appear in security log
2025-03-19 20:38:56 INFO  tech.robd.jwt.util.JwtTokenUtil - JWT secret key loaded from file successfully
2025-03-19 20:38:59 INFO  t.r.jwt.service.DatabaseInitService - Initializing database with domains, roles and users from configuration
2025-03-19 20:38:59 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "2bf38" for domain: app1
2025-03-19 20:38:59 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: app1
2025-03-19 20:38:59 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "a3c70" for domain: default
2025-03-19 20:38:59 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: default
2025-03-19 20:38:59 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 20:38:59 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 20:38:59 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 20:38:59 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 20:38:59 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 20:38:59 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 20:38:59 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "2bf38" for user admin1 in domain: app1
2025-03-19 20:39:00 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user admin1 in domain app1: ADMIN
2025-03-19 20:39:00 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: admin1 in domain: app1
2025-03-19 20:39:00 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "2bf38" for user user1 in domain: app1
2025-03-19 20:39:00 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user1 in domain app1: USER
2025-03-19 20:39:00 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user1 in domain: app1
2025-03-19 20:39:00 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "2bf38" for user user2 in domain: app1
2025-03-19 20:39:00 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user2 in domain app1: USER
2025-03-19 20:39:00 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user2 in domain: app1
2025-03-19 20:39:00 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "2bf38" for user user3 in domain: app1
2025-03-19 20:39:00 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user3 in domain app1: USER
2025-03-19 20:39:00 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user3 in domain: app1
2025-03-19 20:39:00 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "2bf38" for user manager1 in domain: app1
2025-03-19 20:39:01 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: MANAGER
2025-03-19 20:39:01 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: USER
2025-03-19 20:39:01 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: manager1 in domain: app1
2025-03-19 20:39:01 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-03-19 20:39:01 WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 0b60da32-6eb1-44a6-8de4-2884b6c2be63

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-03-19 20:39:01 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@18372705, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@418f0f27, org.springframework.security.web.context.SecurityContextHolderFilter@10806dbe, org.springframework.security.web.header.HeaderWriterFilter@5481001f, org.springframework.security.web.authentication.logout.LogoutFilter@5db6083b, tech.robd.jwt.filter.JwtAuthenticationFilter@64245ca9, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@4c32aa7e, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@1695f7cb, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@3095c449, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@427946b9, org.springframework.security.web.access.ExceptionTranslationFilter@6d0fe80c, org.springframework.security.web.access.intercept.AuthorizationFilter@1418a1bd]
2025-03-19 20:39:03 INFO  o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-03-19 20:39:03 INFO  o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-03-19 20:39:03 INFO  o.s.t.w.s.TestDispatcherServlet - Completed initialization in 2 ms
2025-03-19 20:39:04 INFO  t.r.j.i.AuthenticationIntegrationTest - Started AuthenticationIntegrationTest in 16.855 seconds (process running for 20.406)
2025-03-19 20:39:06 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 20:39:06 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 20:39:06 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 20:39:06 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 20:39:06 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 20:39:06 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 20:39:06 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 20:39:06 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 20:39:06 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/users
2025-03-19 20:39:06 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 20:39:06 DEBUG o.s.s.w.a.AccessDeniedHandlerImpl - Responding with 403 status code
2025-03-19 20:39:06 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 20:39:06 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-03-19 20:39:06 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-03-19 20:39:55 INFO  tech.robd.jwt.JwtAuthApplication - Starting JwtAuthApplication using Java 21.0.3 with PID 35132 (C:\data\work\myframework\simple-spring-jwt-auth\build\classes\java\main started by robde in C:\data\work\myframework\simple-spring-jwt-auth)
2025-03-19 20:39:55 DEBUG tech.robd.jwt.JwtAuthApplication - Running with Spring Boot v3.1.2, Spring v6.0.11
2025-03-19 20:39:55 INFO  tech.robd.jwt.JwtAuthApplication - The following 1 profile is active: "dev"
2025-03-19 20:39:56 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-19 20:39:56 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 102 ms. Found 3 JPA repository interfaces.
2025-03-19 20:39:57 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8081 (http)
2025-03-19 20:39:57 INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-03-19 20:39:57 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-03-19 20:39:57 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.11]
2025-03-19 20:39:57 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-03-19 20:39:57 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2039 ms
2025-03-19 20:39:57 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-03-19 20:39:58 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:jwt_auth user=SA
2025-03-19 20:39:58 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-03-19 20:39:58 INFO  o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:jwt_auth'
2025-03-19 20:39:58 INFO  tech.robd.jwt.util.JwtTokenUtil - JWT secret key loaded from file successfully
2025-03-19 20:39:58 DEBUG t.r.j.filter.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-03-19 20:39:58 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-19 20:39:58 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.2.6.Final
2025-03-19 20:39:58 INFO  org.hibernate.cfg.Environment - HHH000406: Using bytecode reflection optimizer
2025-03-19 20:39:58 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 20:39:58 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-19 20:39:59 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 20:39:59 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-03-19 20:39:59 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 20:39:59 ERROR t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST ERROR LOG - Should appear in console
2025-03-19 20:39:59 WARN  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST WARNING LOG - Should appear in console
2025-03-19 20:39:59 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST INFO LOG - Should appear in console
2025-03-19 20:39:59 DEBUG t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST DEBUG LOG - May or may not appear depending on level
2025-03-19 20:39:59 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST SECURITY LOG - Should appear in security log
2025-03-19 20:40:00 INFO  t.r.jwt.service.DatabaseInitService - Initializing database with domains, roles and users from configuration
2025-03-19 20:40:00 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "c707b" for domain: app1
2025-03-19 20:40:00 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: app1
2025-03-19 20:40:00 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "7215f" for domain: default
2025-03-19 20:40:00 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: default
2025-03-19 20:40:00 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 20:40:00 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 20:40:00 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 20:40:00 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 20:40:00 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 20:40:00 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 20:40:00 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "c707b" for user admin1 in domain: app1
2025-03-19 20:40:01 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user admin1 in domain app1: ADMIN
2025-03-19 20:40:01 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: admin1 in domain: app1
2025-03-19 20:40:01 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "c707b" for user user1 in domain: app1
2025-03-19 20:40:01 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user1 in domain app1: USER
2025-03-19 20:40:01 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user1 in domain: app1
2025-03-19 20:40:01 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "c707b" for user user2 in domain: app1
2025-03-19 20:40:01 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user2 in domain app1: USER
2025-03-19 20:40:01 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user2 in domain: app1
2025-03-19 20:40:01 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "c707b" for user user3 in domain: app1
2025-03-19 20:40:01 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user3 in domain app1: USER
2025-03-19 20:40:01 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user3 in domain: app1
2025-03-19 20:40:01 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "c707b" for user manager1 in domain: app1
2025-03-19 20:40:01 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: MANAGER
2025-03-19 20:40:01 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: USER
2025-03-19 20:40:01 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: manager1 in domain: app1
2025-03-19 20:40:01 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-03-19 20:40:01 WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 45bcd644-ddc9-429f-b575-6362d017b75f

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-03-19 20:40:02 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@628e0403, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@3a70acd5, org.springframework.security.web.context.SecurityContextHolderFilter@7375ebe7, org.springframework.security.web.header.HeaderWriterFilter@101eb529, org.springframework.security.web.authentication.logout.LogoutFilter@23f27434, tech.robd.jwt.filter.JwtAuthenticationFilter@134a8ead, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@6d76aa05, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@207358ad, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@3e2ee637, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@475fb7, org.springframework.security.web.access.ExceptionTranslationFilter@14a488ed, org.springframework.security.web.access.intercept.AuthorizationFilter@2d541e01]
2025-03-19 20:40:02 INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-03-19 20:40:02 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8081 (http) with context path ''
2025-03-19 20:40:02 INFO  tech.robd.jwt.JwtAuthApplication - Started JwtAuthApplication in 8.659 seconds (process running for 10.014)
2025-03-19 20:40:24 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-03-19 20:40:24 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-03-19 20:40:24 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-03-19 20:40:24 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 20:40:24 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 20:40:24 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 20:40:24 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: user1
2025-03-19 20:40:24 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: user1
2025-03-19 20:40:25 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: user1
2025-03-19 20:40:25 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'user1'
2025-03-19 20:40:25 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 20:40:39 DEBUG o.s.security.web.FilterChainProxy - Securing GET /authenticate
2025-03-19 20:40:39 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 20:40:39 DEBUG o.s.security.web.FilterChainProxy - Secured GET /authenticate
2025-03-19 20:40:39 WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpRequestMethodNotSupportedException: Request method 'GET' is not supported]
2025-03-19 20:40:39 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 20:40:39 DEBUG o.s.security.web.FilterChainProxy - Securing GET /error
2025-03-19 20:40:39 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 20:40:39 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost:8081/error?continue to session
2025-03-19 20:40:39 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 20:40:39 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@23f66e11
2025-03-19 20:41:26 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/users
2025-03-19 20:41:26 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 20:41:26 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 20:41:26 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost:8081/api/users?continue to session
2025-03-19 20:41:26 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 20:41:26 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@23f66e11
2025-03-19 20:41:26 DEBUG o.s.security.web.FilterChainProxy - Securing GET /error
2025-03-19 20:41:26 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 20:41:26 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost:8081/error?continue to session
2025-03-19 20:41:26 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 20:41:26 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@23f66e11
2025-03-19 20:42:32 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/users
2025-03-19 20:42:32 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 20:42:32 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 20:42:32 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost:8081/api/users?continue to session
2025-03-19 20:42:32 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 20:42:32 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@23f66e11
2025-03-19 20:42:32 DEBUG o.s.security.web.FilterChainProxy - Securing GET /error
2025-03-19 20:42:32 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 20:42:32 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost:8081/error?continue to session
2025-03-19 20:42:32 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 20:42:32 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@23f66e11
2025-03-19 20:44:27 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/users
2025-03-19 20:44:27 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 20:44:27 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 20:44:27 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost:8081/api/users?continue to session
2025-03-19 20:44:27 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 20:44:27 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@23f66e11
2025-03-19 20:44:27 DEBUG o.s.security.web.FilterChainProxy - Securing GET /error
2025-03-19 20:44:27 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 20:44:27 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost:8081/error?continue to session
2025-03-19 20:44:27 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 20:44:27 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@23f66e11
2025-03-19 20:47:13 DEBUG o.s.security.web.FilterChainProxy - Securing GET /authenticate
2025-03-19 20:47:13 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 20:47:13 DEBUG o.s.security.web.FilterChainProxy - Secured GET /authenticate
2025-03-19 20:47:13 WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpRequestMethodNotSupportedException: Request method 'GET' is not supported]
2025-03-19 20:47:13 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 20:47:13 DEBUG o.s.security.web.FilterChainProxy - Securing GET /error
2025-03-19 20:47:13 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 20:47:13 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost:8081/error?continue to session
2025-03-19 20:47:13 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 20:47:13 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@23f66e11
2025-03-19 20:59:21 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 20:59:21 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-03-19 20:59:21 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-03-19 20:59:55 INFO  t.r.j.i.AuthenticationIntegrationTest - Starting AuthenticationIntegrationTest using Java 21.0.3 with PID 17152 (started by robde in C:\data\work\myframework\simple-spring-jwt-auth)
2025-03-19 20:59:55 DEBUG t.r.j.i.AuthenticationIntegrationTest - Running with Spring Boot v3.1.2, Spring v6.0.11
2025-03-19 20:59:55 INFO  t.r.j.i.AuthenticationIntegrationTest - The following 1 profile is active: "test"
2025-03-19 20:59:57 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-19 20:59:57 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 91 ms. Found 3 JPA repository interfaces.
2025-03-19 20:59:58 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-03-19 20:59:58 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:39bd7fcc-3ddd-4faa-bd75-5eb8d5138f69 user=SA
2025-03-19 20:59:58 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-03-19 20:59:58 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-19 20:59:58 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.2.6.Final
2025-03-19 20:59:58 INFO  org.hibernate.cfg.Environment - HHH000406: Using bytecode reflection optimizer
2025-03-19 20:59:59 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 20:59:59 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-19 20:59:59 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 21:00:00 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-03-19 21:00:00 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 21:00:00 ERROR t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST ERROR LOG - Should appear in console
2025-03-19 21:00:00 WARN  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST WARNING LOG - Should appear in console
2025-03-19 21:00:00 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST INFO LOG - Should appear in console
2025-03-19 21:00:00 DEBUG t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST DEBUG LOG - May or may not appear depending on level
2025-03-19 21:00:00 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST SECURITY LOG - Should appear in security log
2025-03-19 21:00:00 INFO  tech.robd.jwt.util.JwtTokenUtil - JWT secret key loaded from file successfully
2025-03-19 21:00:01 INFO  t.r.jwt.service.DatabaseInitService - Initializing database with domains, roles and users from configuration
2025-03-19 21:00:01 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "ea4b5" for domain: app1
2025-03-19 21:00:01 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: app1
2025-03-19 21:00:01 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "89131" for domain: default
2025-03-19 21:00:01 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: default
2025-03-19 21:00:01 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 21:00:01 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 21:00:01 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 21:00:01 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 21:00:01 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 21:00:01 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 21:00:01 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "ea4b5" for user admin1 in domain: app1
2025-03-19 21:00:01 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user admin1 in domain app1: ADMIN
2025-03-19 21:00:01 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: admin1 in domain: app1
2025-03-19 21:00:01 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "ea4b5" for user user1 in domain: app1
2025-03-19 21:00:01 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user1 in domain app1: USER
2025-03-19 21:00:01 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user1 in domain: app1
2025-03-19 21:00:01 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "ea4b5" for user user2 in domain: app1
2025-03-19 21:00:02 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user2 in domain app1: USER
2025-03-19 21:00:02 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user2 in domain: app1
2025-03-19 21:00:02 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "ea4b5" for user user3 in domain: app1
2025-03-19 21:00:02 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user3 in domain app1: USER
2025-03-19 21:00:02 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user3 in domain: app1
2025-03-19 21:00:02 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "ea4b5" for user manager1 in domain: app1
2025-03-19 21:00:02 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: MANAGER
2025-03-19 21:00:02 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: USER
2025-03-19 21:00:02 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: manager1 in domain: app1
2025-03-19 21:00:02 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-03-19 21:00:02 WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 6909df32-c7a9-4214-bd00-a72c2773f5ee

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-03-19 21:00:02 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@38c9e937, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@26401eda, org.springframework.security.web.context.SecurityContextHolderFilter@6aeb769d, org.springframework.security.web.header.HeaderWriterFilter@638b05fb, org.springframework.security.web.authentication.logout.LogoutFilter@2ecb87b2, tech.robd.jwt.filter.JwtAuthenticationFilter@89178b4, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@416bff93, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@7234db3, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@189c6683, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@79e591bb, org.springframework.security.web.access.ExceptionTranslationFilter@31e5d408, org.springframework.security.web.access.intercept.AuthorizationFilter@7bfedff3]
2025-03-19 21:00:03 INFO  o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-03-19 21:00:03 INFO  o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-03-19 21:00:03 INFO  o.s.t.w.s.TestDispatcherServlet - Completed initialization in 2 ms
2025-03-19 21:00:03 INFO  t.r.j.i.AuthenticationIntegrationTest - Started AuthenticationIntegrationTest in 8.66 seconds (process running for 10.62)
2025-03-19 21:00:04 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:00:04 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:00:04 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:00:05 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:00:05 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 21:00:05 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 21:00:05 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 21:00:05 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:00:05 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/isuservalid
2025-03-19 21:00:05 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 21:00:05 DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/isuservalid
2025-03-19 21:00:05 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 21:00:05 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-03-19 21:00:05 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-03-19 21:00:48 INFO  t.r.j.i.AuthenticationIntegrationTest - Starting AuthenticationIntegrationTest using Java 21.0.3 with PID 11476 (started by robde in C:\data\work\myframework\simple-spring-jwt-auth)
2025-03-19 21:00:48 DEBUG t.r.j.i.AuthenticationIntegrationTest - Running with Spring Boot v3.1.2, Spring v6.0.11
2025-03-19 21:00:48 INFO  t.r.j.i.AuthenticationIntegrationTest - The following 1 profile is active: "test"
2025-03-19 21:00:49 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-19 21:00:49 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 79 ms. Found 3 JPA repository interfaces.
2025-03-19 21:00:50 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-03-19 21:00:51 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:8be03a32-8a31-48d4-875a-2db159128c6f user=SA
2025-03-19 21:00:51 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-03-19 21:00:51 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-19 21:00:51 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.2.6.Final
2025-03-19 21:00:51 INFO  org.hibernate.cfg.Environment - HHH000406: Using bytecode reflection optimizer
2025-03-19 21:00:51 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 21:00:51 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-19 21:00:52 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 21:00:52 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-03-19 21:00:53 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 21:00:53 ERROR t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST ERROR LOG - Should appear in console
2025-03-19 21:00:53 WARN  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST WARNING LOG - Should appear in console
2025-03-19 21:00:53 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST INFO LOG - Should appear in console
2025-03-19 21:00:53 DEBUG t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST DEBUG LOG - May or may not appear depending on level
2025-03-19 21:00:53 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST SECURITY LOG - Should appear in security log
2025-03-19 21:00:53 INFO  tech.robd.jwt.util.JwtTokenUtil - JWT secret key loaded from file successfully
2025-03-19 21:00:53 INFO  t.r.jwt.service.DatabaseInitService - Initializing database with domains, roles and users from configuration
2025-03-19 21:00:54 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "074cf" for domain: app1
2025-03-19 21:00:54 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: app1
2025-03-19 21:00:54 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "3e5a8" for domain: default
2025-03-19 21:00:54 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: default
2025-03-19 21:00:54 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 21:00:54 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 21:00:54 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 21:00:54 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 21:00:54 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 21:00:54 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 21:00:54 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "074cf" for user admin1 in domain: app1
2025-03-19 21:00:54 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user admin1 in domain app1: ADMIN
2025-03-19 21:00:54 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: admin1 in domain: app1
2025-03-19 21:00:54 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "074cf" for user user1 in domain: app1
2025-03-19 21:00:54 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user1 in domain app1: USER
2025-03-19 21:00:54 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user1 in domain: app1
2025-03-19 21:00:54 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "074cf" for user user2 in domain: app1
2025-03-19 21:00:54 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user2 in domain app1: USER
2025-03-19 21:00:54 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user2 in domain: app1
2025-03-19 21:00:54 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "074cf" for user user3 in domain: app1
2025-03-19 21:00:54 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user3 in domain app1: USER
2025-03-19 21:00:54 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user3 in domain: app1
2025-03-19 21:00:54 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "074cf" for user manager1 in domain: app1
2025-03-19 21:00:54 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: MANAGER
2025-03-19 21:00:54 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: USER
2025-03-19 21:00:54 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: manager1 in domain: app1
2025-03-19 21:00:54 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-03-19 21:00:55 WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: b897eb8d-ecf6-48ad-852b-c9de57f5d3a3

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-03-19 21:00:55 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@3fc064cb, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@4bacabc4, org.springframework.security.web.context.SecurityContextHolderFilter@11e36e5c, org.springframework.security.web.header.HeaderWriterFilter@36003e90, org.springframework.security.web.authentication.logout.LogoutFilter@2ab87cb8, tech.robd.jwt.filter.JwtAuthenticationFilter@66cb9a63, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@1b5df8b7, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@126ae0ca, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@59e24c62, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@508de524, org.springframework.security.web.access.ExceptionTranslationFilter@393aac93, org.springframework.security.web.access.intercept.AuthorizationFilter@18372705]
2025-03-19 21:00:56 INFO  o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-03-19 21:00:56 INFO  o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-03-19 21:00:56 INFO  o.s.t.w.s.TestDispatcherServlet - Completed initialization in 1 ms
2025-03-19 21:00:56 INFO  t.r.j.i.AuthenticationIntegrationTest - Started AuthenticationIntegrationTest in 8.62 seconds (process running for 10.608)
2025-03-19 21:00:57 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:00:57 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:00:57 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:00:57 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:00:57 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 21:00:57 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 21:00:57 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 21:00:57 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:00:57 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/isuservalid
2025-03-19 21:00:57 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 21:00:57 DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/isuservalid
2025-03-19 21:00:57 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:00:57 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:00:57 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:00:57 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:00:57 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 21:00:58 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 21:00:58 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 21:00:58 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:00:58 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/admin/users
2025-03-19 21:00:58 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 21:00:58 DEBUG o.s.s.w.a.AccessDeniedHandlerImpl - Responding with 403 status code
2025-03-19 21:00:58 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/isuservalid
2025-03-19 21:00:58 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:00:58 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:00:58 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost/api/isuservalid?continue to session
2025-03-19 21:00:58 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 21:00:58 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@18563d10
2025-03-19 21:00:58 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:00:58 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:00:58 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:00:58 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:00:58 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 21:00:58 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 21:00:58 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 21:00:58 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:00:58 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:00:58 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:00:58 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:00:58 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:00:58 WARN  t.robd.jwt.controller.AuthController - Authentication failed: username or domain is missing
2025-03-19 21:00:58 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:00:58 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:00:58 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:00:58 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:00:58 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: nonexistentuser
2025-03-19 21:00:58 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: nonexistentuser
2025-03-19 21:00:58 WARN  tech.robd.jwt.service.UserService - User not found: nonexistentuser
2025-03-19 21:00:58 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:00:59 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/isuservalid
2025-03-19 21:00:59 ERROR tech.robd.jwt.util.JwtTokenUtil - JWT token validation error
io.jsonwebtoken.MalformedJwtException: JWT strings must contain exactly 2 period characters. Found: 0
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:275)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at tech.robd.jwt.util.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:125)
	at tech.robd.jwt.util.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:117)
	at tech.robd.jwt.util.JwtTokenUtil.getExpirationDateFromToken(JwtTokenUtil.java:113)
	at tech.robd.jwt.util.JwtTokenUtil.isTokenExpired(JwtTokenUtil.java:139)
	at tech.robd.jwt.util.JwtTokenUtil.validateToken(JwtTokenUtil.java:131)
	at tech.robd.jwt.filter.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:43)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at tech.robd.jwt.integration.AuthenticationIntegrationTest.testProtectedEndpointWithInvalidToken(AuthenticationIntegrationTest.java:190)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:727)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.processAllTestClasses(JUnitPlatformTestClassProcessor.java:124)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.access$000(JUnitPlatformTestClassProcessor.java:99)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor.stop(JUnitPlatformTestClassProcessor.java:94)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.stop(SuiteTestClassProcessor.java:63)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:92)
	at jdk.proxy1/jdk.proxy1.$Proxy4.stop(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker$3.run(TestWorker.java:200)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:132)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:103)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:63)
	at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:121)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)
2025-03-19 21:00:59 WARN  t.r.j.filter.JwtAuthenticationFilter - Invalid JWT token provided
2025-03-19 21:00:59 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:00:59 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost/api/isuservalid?continue to session
2025-03-19 21:00:59 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 21:00:59 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@18563d10
2025-03-19 21:00:59 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:00:59 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:00:59 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:00:59 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:00:59 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 21:00:59 WARN  tech.robd.jwt.service.UserService - Invalid password for user: testuser
2025-03-19 21:00:59 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:00:59 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 21:00:59 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-03-19 21:00:59 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-03-19 21:09:53 INFO  t.r.j.i.AuthenticationIntegrationTest - Starting AuthenticationIntegrationTest using Java 21.0.3 with PID 26444 (started by robde in C:\data\work\myframework\simple-spring-jwt-auth)
2025-03-19 21:09:53 DEBUG t.r.j.i.AuthenticationIntegrationTest - Running with Spring Boot v3.1.2, Spring v6.0.11
2025-03-19 21:09:53 INFO  t.r.j.i.AuthenticationIntegrationTest - The following 1 profile is active: "test"
2025-03-19 21:09:54 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-19 21:09:55 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 83 ms. Found 3 JPA repository interfaces.
2025-03-19 21:09:56 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-03-19 21:09:56 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:7fee35cf-fc34-4761-8549-194f206763e5 user=SA
2025-03-19 21:09:56 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-03-19 21:09:56 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-19 21:09:56 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.2.6.Final
2025-03-19 21:09:56 INFO  org.hibernate.cfg.Environment - HHH000406: Using bytecode reflection optimizer
2025-03-19 21:09:56 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 21:09:57 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-19 21:09:57 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 21:09:58 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-03-19 21:09:58 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 21:09:58 ERROR t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST ERROR LOG - Should appear in console
2025-03-19 21:09:58 WARN  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST WARNING LOG - Should appear in console
2025-03-19 21:09:58 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST INFO LOG - Should appear in console
2025-03-19 21:09:58 DEBUG t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST DEBUG LOG - May or may not appear depending on level
2025-03-19 21:09:58 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST SECURITY LOG - Should appear in security log
2025-03-19 21:09:58 INFO  tech.robd.jwt.util.JwtTokenUtil - JWT secret key loaded from file successfully
2025-03-19 21:09:59 INFO  t.r.jwt.service.DatabaseInitService - Initializing database with domains, roles and users from configuration
2025-03-19 21:09:59 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "ff572" for domain: app1
2025-03-19 21:10:00 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: app1
2025-03-19 21:10:00 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "40dc8" for domain: default
2025-03-19 21:10:00 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: default
2025-03-19 21:10:00 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 21:10:00 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 21:10:00 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 21:10:00 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 21:10:00 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 21:10:00 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 21:10:00 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "ff572" for user admin1 in domain: app1
2025-03-19 21:10:00 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user admin1 in domain app1: ADMIN
2025-03-19 21:10:00 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: admin1 in domain: app1
2025-03-19 21:10:00 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "ff572" for user user1 in domain: app1
2025-03-19 21:10:00 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user1 in domain app1: USER
2025-03-19 21:10:00 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user1 in domain: app1
2025-03-19 21:10:00 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "ff572" for user user2 in domain: app1
2025-03-19 21:10:00 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user2 in domain app1: USER
2025-03-19 21:10:00 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user2 in domain: app1
2025-03-19 21:10:00 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "ff572" for user user3 in domain: app1
2025-03-19 21:10:00 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user3 in domain app1: USER
2025-03-19 21:10:00 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user3 in domain: app1
2025-03-19 21:10:00 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "ff572" for user manager1 in domain: app1
2025-03-19 21:10:00 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: MANAGER
2025-03-19 21:10:00 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: USER
2025-03-19 21:10:00 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: manager1 in domain: app1
2025-03-19 21:10:00 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-03-19 21:10:01 WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 1d3c2e4f-58bd-467d-8bdf-f23f31ea63ff

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-03-19 21:10:01 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@3fc064cb, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@4bacabc4, org.springframework.security.web.context.SecurityContextHolderFilter@11e36e5c, org.springframework.security.web.header.HeaderWriterFilter@36003e90, org.springframework.security.web.authentication.logout.LogoutFilter@2ab87cb8, tech.robd.jwt.filter.JwtAuthenticationFilter@6e111aeb, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@1b5df8b7, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@126ae0ca, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@59e24c62, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@508de524, org.springframework.security.web.access.ExceptionTranslationFilter@393aac93, org.springframework.security.web.access.intercept.AuthorizationFilter@18372705]
2025-03-19 21:10:04 INFO  o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-03-19 21:10:04 INFO  o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-03-19 21:10:04 INFO  o.s.t.w.s.TestDispatcherServlet - Completed initialization in 3 ms
2025-03-19 21:10:04 INFO  t.r.j.i.AuthenticationIntegrationTest - Started AuthenticationIntegrationTest in 11.394 seconds (process running for 13.743)
2025-03-19 21:10:06 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:10:06 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:10:06 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:10:06 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:10:06 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 21:10:06 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 21:10:07 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 21:10:07 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:10:07 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/isuservalid
2025-03-19 21:10:07 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 21:10:07 DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/isuservalid
2025-03-19 21:10:07 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:10:07 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:10:07 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:10:07 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:10:07 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 21:10:07 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 21:10:07 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 21:10:07 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:10:07 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/admin/users
2025-03-19 21:10:07 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 21:10:07 DEBUG o.s.s.w.a.AccessDeniedHandlerImpl - Responding with 403 status code
2025-03-19 21:10:07 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/isuservalid
2025-03-19 21:10:07 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:10:07 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:10:07 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost/api/isuservalid?continue to session
2025-03-19 21:10:07 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 21:10:07 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@7798de95
2025-03-19 21:10:07 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:10:07 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:10:07 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:10:07 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:10:07 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 21:10:07 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 21:10:07 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 21:10:07 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:10:07 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:10:07 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:10:07 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:10:07 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:10:07 WARN  t.robd.jwt.controller.AuthController - Authentication failed: username or domain is missing
2025-03-19 21:10:07 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:10:07 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:10:07 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:10:07 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:10:07 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: nonexistentuser
2025-03-19 21:10:07 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: nonexistentuser
2025-03-19 21:10:07 WARN  tech.robd.jwt.service.UserService - User not found: nonexistentuser
2025-03-19 21:10:07 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:10:08 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/isuservalid
2025-03-19 21:10:08 ERROR tech.robd.jwt.util.JwtTokenUtil - JWT token validation error
io.jsonwebtoken.MalformedJwtException: JWT strings must contain exactly 2 period characters. Found: 0
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:275)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at tech.robd.jwt.util.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:125)
	at tech.robd.jwt.util.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:117)
	at tech.robd.jwt.util.JwtTokenUtil.getExpirationDateFromToken(JwtTokenUtil.java:113)
	at tech.robd.jwt.util.JwtTokenUtil.isTokenExpired(JwtTokenUtil.java:139)
	at tech.robd.jwt.util.JwtTokenUtil.validateToken(JwtTokenUtil.java:131)
	at tech.robd.jwt.filter.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:43)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at tech.robd.jwt.integration.AuthenticationIntegrationTest.testProtectedEndpointWithInvalidToken(AuthenticationIntegrationTest.java:190)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:727)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.processAllTestClasses(JUnitPlatformTestClassProcessor.java:124)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.access$000(JUnitPlatformTestClassProcessor.java:99)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor.stop(JUnitPlatformTestClassProcessor.java:94)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.stop(SuiteTestClassProcessor.java:63)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:92)
	at jdk.proxy1/jdk.proxy1.$Proxy4.stop(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker$3.run(TestWorker.java:200)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:132)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:103)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:63)
	at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:121)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)
2025-03-19 21:10:08 WARN  t.r.j.filter.JwtAuthenticationFilter - Invalid JWT token provided
2025-03-19 21:10:08 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:10:08 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost/api/isuservalid?continue to session
2025-03-19 21:10:08 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 21:10:08 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@7798de95
2025-03-19 21:10:08 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:10:08 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:10:08 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:10:08 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:10:08 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 21:10:08 WARN  tech.robd.jwt.service.UserService - Invalid password for user: testuser
2025-03-19 21:10:08 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:10:08 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 21:10:08 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-03-19 21:10:08 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-03-19 21:19:47 INFO  t.r.j.i.AuthenticationIntegrationTest - Starting AuthenticationIntegrationTest using Java 21.0.3 with PID 16732 (started by robde in C:\data\work\myframework\simple-spring-jwt-auth)
2025-03-19 21:19:47 DEBUG t.r.j.i.AuthenticationIntegrationTest - Running with Spring Boot v3.1.2, Spring v6.0.11
2025-03-19 21:19:47 INFO  t.r.j.i.AuthenticationIntegrationTest - The following 1 profile is active: "test"
2025-03-19 21:19:48 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-19 21:19:48 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 84 ms. Found 3 JPA repository interfaces.
2025-03-19 21:19:49 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-03-19 21:19:49 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:84b954bb-543b-4a85-9a2c-eafc5899b792 user=SA
2025-03-19 21:19:49 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-03-19 21:19:50 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-19 21:19:50 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.2.6.Final
2025-03-19 21:19:50 INFO  org.hibernate.cfg.Environment - HHH000406: Using bytecode reflection optimizer
2025-03-19 21:19:50 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 21:19:50 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-19 21:19:51 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 21:19:51 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-03-19 21:19:52 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 21:19:52 ERROR t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST ERROR LOG - Should appear in console
2025-03-19 21:19:52 WARN  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST WARNING LOG - Should appear in console
2025-03-19 21:19:52 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST INFO LOG - Should appear in console
2025-03-19 21:19:52 DEBUG t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST DEBUG LOG - May or may not appear depending on level
2025-03-19 21:19:52 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST SECURITY LOG - Should appear in security log
2025-03-19 21:19:52 INFO  tech.robd.jwt.util.JwtTokenUtil - JWT secret key loaded from file successfully
2025-03-19 21:19:52 INFO  t.r.jwt.service.DatabaseInitService - Initializing database with domains, roles and users from configuration
2025-03-19 21:19:52 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "2b03d" for domain: app1
2025-03-19 21:19:53 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: app1
2025-03-19 21:19:53 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "61bdb" for domain: default
2025-03-19 21:19:53 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: default
2025-03-19 21:19:53 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 21:19:53 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 21:19:53 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 21:19:53 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 21:19:53 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 21:19:53 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 21:19:53 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "2b03d" for user admin1 in domain: app1
2025-03-19 21:19:53 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user admin1 in domain app1: ADMIN
2025-03-19 21:19:53 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: admin1 in domain: app1
2025-03-19 21:19:53 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "2b03d" for user user1 in domain: app1
2025-03-19 21:19:53 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user1 in domain app1: USER
2025-03-19 21:19:53 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user1 in domain: app1
2025-03-19 21:19:53 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "2b03d" for user user2 in domain: app1
2025-03-19 21:19:53 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user2 in domain app1: USER
2025-03-19 21:19:53 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user2 in domain: app1
2025-03-19 21:19:53 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "2b03d" for user user3 in domain: app1
2025-03-19 21:19:53 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user3 in domain app1: USER
2025-03-19 21:19:53 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user3 in domain: app1
2025-03-19 21:19:53 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "2b03d" for user manager1 in domain: app1
2025-03-19 21:19:53 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: MANAGER
2025-03-19 21:19:53 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: USER
2025-03-19 21:19:53 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: manager1 in domain: app1
2025-03-19 21:19:53 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-03-19 21:19:53 WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 421159de-aaf6-4ad6-a4a5-bb33edb39fca

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-03-19 21:19:54 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@2b8a11d7, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@1391d95f, org.springframework.security.web.context.SecurityContextHolderFilter@31e5d408, org.springframework.security.web.header.HeaderWriterFilter@59e24c62, org.springframework.security.web.authentication.logout.LogoutFilter@fd8513b, tech.robd.jwt.filter.JwtAuthenticationFilter@e21d73, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@617d697, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@638b05fb, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@77e42cbf, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@416bff93, org.springframework.security.web.access.ExceptionTranslationFilter@2620264e, org.springframework.security.web.access.intercept.AuthorizationFilter@1f4083ac]
2025-03-19 21:19:55 INFO  o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-03-19 21:19:55 INFO  o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-03-19 21:19:55 INFO  o.s.t.w.s.TestDispatcherServlet - Completed initialization in 2 ms
2025-03-19 21:19:55 INFO  t.r.j.i.AuthenticationIntegrationTest - Started AuthenticationIntegrationTest in 8.94 seconds (process running for 11.154)
2025-03-19 21:19:56 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:19:56 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:19:56 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:19:56 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:19:56 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 21:19:56 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 21:19:56 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 21:19:56 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:19:56 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/isuservalid
2025-03-19 21:19:56 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 21:19:56 DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/isuservalid
2025-03-19 21:19:57 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:19:57 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:19:57 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:19:57 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:19:57 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 21:19:57 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 21:19:57 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 21:19:57 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:19:57 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/admin/users
2025-03-19 21:19:57 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 21:19:57 DEBUG o.s.s.w.a.AccessDeniedHandlerImpl - Responding with 403 status code
2025-03-19 21:19:57 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/isuservalid
2025-03-19 21:19:57 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:19:57 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:19:57 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost/api/isuservalid?continue to session
2025-03-19 21:19:57 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 21:19:57 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@4fc41cba
2025-03-19 21:19:57 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:19:57 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:19:57 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:19:57 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:19:57 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 21:19:57 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 21:19:57 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 21:19:57 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:19:57 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:19:57 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:19:57 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:19:57 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:19:57 WARN  t.robd.jwt.controller.AuthController - Authentication failed: username or domain is missing
2025-03-19 21:19:57 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:19:57 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:19:57 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:19:57 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:19:57 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: nonexistentuser
2025-03-19 21:19:57 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: nonexistentuser
2025-03-19 21:19:57 WARN  tech.robd.jwt.service.UserService - User not found: nonexistentuser
2025-03-19 21:19:57 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:19:58 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/isuservalid
2025-03-19 21:19:58 ERROR tech.robd.jwt.util.JwtTokenUtil - JWT token validation error
io.jsonwebtoken.MalformedJwtException: JWT strings must contain exactly 2 period characters. Found: 0
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:275)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at tech.robd.jwt.util.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:125)
	at tech.robd.jwt.util.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:117)
	at tech.robd.jwt.util.JwtTokenUtil.getExpirationDateFromToken(JwtTokenUtil.java:113)
	at tech.robd.jwt.util.JwtTokenUtil.isTokenExpired(JwtTokenUtil.java:139)
	at tech.robd.jwt.util.JwtTokenUtil.validateToken(JwtTokenUtil.java:131)
	at tech.robd.jwt.filter.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:43)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at tech.robd.jwt.integration.AuthenticationIntegrationTest.testProtectedEndpointWithInvalidToken(AuthenticationIntegrationTest.java:190)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:727)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.processAllTestClasses(JUnitPlatformTestClassProcessor.java:124)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.access$000(JUnitPlatformTestClassProcessor.java:99)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor.stop(JUnitPlatformTestClassProcessor.java:94)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.stop(SuiteTestClassProcessor.java:63)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:92)
	at jdk.proxy1/jdk.proxy1.$Proxy4.stop(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker$3.run(TestWorker.java:200)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:132)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:103)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:63)
	at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:121)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)
2025-03-19 21:19:58 WARN  t.r.j.filter.JwtAuthenticationFilter - Invalid JWT token provided
2025-03-19 21:19:58 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:19:58 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost/api/isuservalid?continue to session
2025-03-19 21:19:58 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 21:19:58 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@4fc41cba
2025-03-19 21:19:58 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:19:58 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:19:58 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:19:58 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:19:58 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 21:19:58 WARN  tech.robd.jwt.service.UserService - Invalid password for user: testuser
2025-03-19 21:19:58 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:19:58 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 21:19:58 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-03-19 21:19:58 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-03-19 21:33:41 INFO  t.r.j.i.AuthenticationIntegrationTest - Starting AuthenticationIntegrationTest using Java 21.0.3 with PID 15052 (started by robde in C:\data\work\myframework\simple-spring-jwt-auth)
2025-03-19 21:33:41 DEBUG t.r.j.i.AuthenticationIntegrationTest - Running with Spring Boot v3.1.2, Spring v6.0.11
2025-03-19 21:33:41 INFO  t.r.j.i.AuthenticationIntegrationTest - The following 1 profile is active: "test"
2025-03-19 21:33:42 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-19 21:33:42 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 90 ms. Found 3 JPA repository interfaces.
2025-03-19 21:33:43 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-03-19 21:33:44 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:2bb91424-59bc-4c7b-97bb-6e554b41778e user=SA
2025-03-19 21:33:44 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-03-19 21:33:44 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-19 21:33:44 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.2.6.Final
2025-03-19 21:33:44 INFO  org.hibernate.cfg.Environment - HHH000406: Using bytecode reflection optimizer
2025-03-19 21:33:44 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 21:33:45 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-19 21:33:45 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 21:33:46 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-03-19 21:33:46 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 21:33:46 ERROR t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST ERROR LOG - Should appear in console
2025-03-19 21:33:46 WARN  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST WARNING LOG - Should appear in console
2025-03-19 21:33:46 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST INFO LOG - Should appear in console
2025-03-19 21:33:46 DEBUG t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST DEBUG LOG - May or may not appear depending on level
2025-03-19 21:33:46 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST SECURITY LOG - Should appear in security log
2025-03-19 21:33:46 INFO  tech.robd.jwt.util.JwtTokenUtil - JWT secret key loaded from file successfully
2025-03-19 21:33:47 INFO  t.r.jwt.service.DatabaseInitService - Initializing database with domains, roles and users from configuration
2025-03-19 21:33:48 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "63da4" for domain: app1
2025-03-19 21:33:48 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: app1
2025-03-19 21:33:48 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "d319a" for domain: default
2025-03-19 21:33:48 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: default
2025-03-19 21:33:48 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 21:33:48 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 21:33:48 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 21:33:48 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 21:33:48 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 21:33:48 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 21:33:48 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "63da4" for user admin1 in domain: app1
2025-03-19 21:33:48 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user admin1 in domain app1: ADMIN
2025-03-19 21:33:48 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: admin1 in domain: app1
2025-03-19 21:33:48 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "63da4" for user user1 in domain: app1
2025-03-19 21:33:48 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user1 in domain app1: USER
2025-03-19 21:33:48 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user1 in domain: app1
2025-03-19 21:33:48 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "63da4" for user user2 in domain: app1
2025-03-19 21:33:48 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user2 in domain app1: USER
2025-03-19 21:33:48 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user2 in domain: app1
2025-03-19 21:33:48 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "63da4" for user user3 in domain: app1
2025-03-19 21:33:48 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user3 in domain app1: USER
2025-03-19 21:33:48 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user3 in domain: app1
2025-03-19 21:33:48 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "63da4" for user manager1 in domain: app1
2025-03-19 21:33:48 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: MANAGER
2025-03-19 21:33:48 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: USER
2025-03-19 21:33:48 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: manager1 in domain: app1
2025-03-19 21:33:48 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-03-19 21:33:49 WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: d713a0db-0866-480c-8d81-4bb82f85a7dc

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-03-19 21:33:49 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@617d697, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@3a4d0ca2, org.springframework.security.web.context.SecurityContextHolderFilter@59e24c62, org.springframework.security.web.header.HeaderWriterFilter@11e36e5c, org.springframework.security.web.authentication.logout.LogoutFilter@25865fca, tech.robd.jwt.filter.JwtAuthenticationFilter@55a5eea3, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@3fc064cb, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@744c16fb, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@31e5d408, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@149162a4, org.springframework.security.web.access.ExceptionTranslationFilter@5a1ddc7c, org.springframework.security.web.access.intercept.AuthorizationFilter@fe58644]
2025-03-19 21:33:50 INFO  o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-03-19 21:33:50 INFO  o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-03-19 21:33:50 INFO  o.s.t.w.s.TestDispatcherServlet - Completed initialization in 2 ms
2025-03-19 21:33:50 INFO  t.r.j.i.AuthenticationIntegrationTest - Started AuthenticationIntegrationTest in 9.684 seconds (process running for 11.683)
2025-03-19 21:33:51 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:33:51 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:33:51 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:33:51 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:33:51 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 21:33:51 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 21:33:51 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 21:33:51 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:33:51 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/isuservalid
2025-03-19 21:33:51 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 21:33:51 DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/isuservalid
2025-03-19 21:33:52 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:33:52 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:33:52 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:33:52 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:33:52 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 21:33:52 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 21:33:52 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 21:33:52 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:33:52 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/admin/users
2025-03-19 21:33:52 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: testuser
2025-03-19 21:33:52 DEBUG o.s.s.w.a.AccessDeniedHandlerImpl - Responding with 403 status code
2025-03-19 21:33:52 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/isuservalid
2025-03-19 21:33:52 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:33:52 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:33:52 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost/api/isuservalid?continue to session
2025-03-19 21:33:52 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 21:33:52 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@2e78213c
2025-03-19 21:33:52 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:33:52 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:33:52 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:33:52 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:33:52 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 21:33:52 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: testuser
2025-03-19 21:33:52 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'testuser'
2025-03-19 21:33:52 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:33:52 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:33:52 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:33:52 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:33:52 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:33:52 WARN  t.robd.jwt.controller.AuthController - Authentication failed: username or domain is missing
2025-03-19 21:33:52 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:33:52 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:33:52 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:33:52 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:33:52 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: nonexistentuser
2025-03-19 21:33:52 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: nonexistentuser
2025-03-19 21:33:52 WARN  tech.robd.jwt.service.UserService - User not found: nonexistentuser
2025-03-19 21:33:52 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:33:52 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/isuservalid
2025-03-19 21:33:52 ERROR tech.robd.jwt.util.JwtTokenUtil - JWT token validation error
io.jsonwebtoken.MalformedJwtException: JWT strings must contain exactly 2 period characters. Found: 0
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:275)
	at io.jsonwebtoken.impl.DefaultJwtParser.parse(DefaultJwtParser.java:529)
	at io.jsonwebtoken.impl.DefaultJwtParser.parseClaimsJws(DefaultJwtParser.java:589)
	at io.jsonwebtoken.impl.ImmutableJwtParser.parseClaimsJws(ImmutableJwtParser.java:173)
	at tech.robd.jwt.util.JwtTokenUtil.getAllClaimsFromToken(JwtTokenUtil.java:125)
	at tech.robd.jwt.util.JwtTokenUtil.getClaimFromToken(JwtTokenUtil.java:117)
	at tech.robd.jwt.util.JwtTokenUtil.getExpirationDateFromToken(JwtTokenUtil.java:113)
	at tech.robd.jwt.util.JwtTokenUtil.isTokenExpired(JwtTokenUtil.java:139)
	at tech.robd.jwt.util.JwtTokenUtil.validateToken(JwtTokenUtil.java:131)
	at tech.robd.jwt.filter.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:43)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at tech.robd.jwt.integration.AuthenticationIntegrationTest.testProtectedEndpointWithInvalidToken(AuthenticationIntegrationTest.java:190)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:727)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.processAllTestClasses(JUnitPlatformTestClassProcessor.java:124)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.access$000(JUnitPlatformTestClassProcessor.java:99)
	at org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor.stop(JUnitPlatformTestClassProcessor.java:94)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.stop(SuiteTestClassProcessor.java:63)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:92)
	at jdk.proxy1/jdk.proxy1.$Proxy4.stop(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker$3.run(TestWorker.java:200)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:132)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:103)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:63)
	at org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:121)
	at org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)
	at worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)
2025-03-19 21:33:52 WARN  t.r.j.filter.JwtAuthenticationFilter - Invalid JWT token provided
2025-03-19 21:33:52 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:33:53 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost/api/isuservalid?continue to session
2025-03-19 21:33:53 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 21:33:53 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@2e78213c
2025-03-19 21:33:53 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:33:53 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:33:53 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:33:53 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: testuser
2025-03-19 21:33:53 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: testuser
2025-03-19 21:33:53 WARN  tech.robd.jwt.service.UserService - Invalid password for user: testuser
2025-03-19 21:33:53 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:33:53 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 21:33:53 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-03-19 21:33:53 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-03-19 21:34:00 INFO  tech.robd.jwt.JwtAuthApplication - Starting JwtAuthApplication using Java 21.0.3 with PID 27004 (C:\data\work\myframework\simple-spring-jwt-auth\build\classes\java\main started by robde in C:\data\work\myframework\simple-spring-jwt-auth)
2025-03-19 21:34:00 DEBUG tech.robd.jwt.JwtAuthApplication - Running with Spring Boot v3.1.2, Spring v6.0.11
2025-03-19 21:34:00 INFO  tech.robd.jwt.JwtAuthApplication - The following 1 profile is active: "dev"
2025-03-19 21:34:01 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-03-19 21:34:01 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 81 ms. Found 3 JPA repository interfaces.
2025-03-19 21:34:02 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8081 (http)
2025-03-19 21:34:02 INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8081"]
2025-03-19 21:34:02 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-03-19 21:34:02 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.11]
2025-03-19 21:34:02 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-03-19 21:34:02 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2397 ms
2025-03-19 21:34:02 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-03-19 21:34:03 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:jwt_auth user=SA
2025-03-19 21:34:03 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-03-19 21:34:03 INFO  o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:jwt_auth'
2025-03-19 21:34:03 INFO  tech.robd.jwt.util.JwtTokenUtil - JWT secret key loaded from file successfully
2025-03-19 21:34:03 DEBUG t.r.j.filter.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-03-19 21:34:03 INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-03-19 21:34:03 INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.2.6.Final
2025-03-19 21:34:03 INFO  org.hibernate.cfg.Environment - HHH000406: Using bytecode reflection optimizer
2025-03-19 21:34:03 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 21:34:03 INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-03-19 21:34:04 INFO  o.h.b.i.BytecodeProviderInitiator - HHH000021: Bytecode provider name : bytebuddy
2025-03-19 21:34:05 INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-03-19 21:34:05 INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-03-19 21:34:05 ERROR t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST ERROR LOG - Should appear in console
2025-03-19 21:34:05 WARN  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST WARNING LOG - Should appear in console
2025-03-19 21:34:05 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST INFO LOG - Should appear in console
2025-03-19 21:34:05 DEBUG t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST DEBUG LOG - May or may not appear depending on level
2025-03-19 21:34:05 INFO  t.r.j.JwtAuthApplication$$SpringCGLIB$$0 - TEST SECURITY LOG - Should appear in security log
2025-03-19 21:34:05 INFO  t.r.jwt.service.DatabaseInitService - Initializing database with domains, roles and users from configuration
2025-03-19 21:34:05 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "781fc" for domain: app1
2025-03-19 21:34:06 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: app1
2025-03-19 21:34:06 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Created random default pin "068d8" for domain: default
2025-03-19 21:34:06 INFO  t.r.jwt.service.DatabaseInitService - Created domain from configuration: default
2025-03-19 21:34:06 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 21:34:06 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 21:34:06 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 21:34:06 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role ADMIN: null
2025-03-19 21:34:06 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role USER: null
2025-03-19 21:34:06 WARN  t.r.jwt.service.DatabaseInitService - Domain not found for role MANAGER: null
2025-03-19 21:34:06 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "781fc" for user admin1 in domain: app1
2025-03-19 21:34:06 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user admin1 in domain app1: ADMIN
2025-03-19 21:34:06 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: admin1 in domain: app1
2025-03-19 21:34:06 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "781fc" for user user1 in domain: app1
2025-03-19 21:34:06 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user1 in domain app1: USER
2025-03-19 21:34:06 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user1 in domain: app1
2025-03-19 21:34:06 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "781fc" for user user2 in domain: app1
2025-03-19 21:34:06 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user2 in domain app1: USER
2025-03-19 21:34:06 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user2 in domain: app1
2025-03-19 21:34:06 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "781fc" for user user3 in domain: app1
2025-03-19 21:34:06 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user user3 in domain app1: USER
2025-03-19 21:34:06 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: user3 in domain: app1
2025-03-19 21:34:06 INFO  t.r.jwt.service.DatabaseInitService - IMPORTANT INFORMATION: Using DOMAIN DEFAULT pin "781fc" for user manager1 in domain: app1
2025-03-19 21:34:06 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: MANAGER
2025-03-19 21:34:06 WARN  t.r.jwt.service.DatabaseInitService - Role not found for user manager1 in domain app1: USER
2025-03-19 21:34:06 INFO  t.r.jwt.service.DatabaseInitService - Created user from configuration: manager1 in domain: app1
2025-03-19 21:34:06 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-03-19 21:34:06 WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 9beb77fa-01f7-46f4-993e-aeaa727e8c89

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-03-19 21:34:07 INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@6f45be6f, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@65384249, org.springframework.security.web.context.SecurityContextHolderFilter@7f93fce1, org.springframework.security.web.header.HeaderWriterFilter@7a5a26b7, org.springframework.security.web.authentication.logout.LogoutFilter@19ea65f4, tech.robd.jwt.filter.JwtAuthenticationFilter@282c4da0, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@20c55658, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4690a37e, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@23f27434, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@6441db2c, org.springframework.security.web.access.ExceptionTranslationFilter@752573df, org.springframework.security.web.access.intercept.AuthorizationFilter@4505ec36]
2025-03-19 21:34:07 INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8081"]
2025-03-19 21:34:07 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8081 (http) with context path ''
2025-03-19 21:34:07 INFO  tech.robd.jwt.JwtAuthApplication - Started JwtAuthApplication in 9.123 seconds (process running for 10.573)
2025-03-19 21:34:16 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-03-19 21:34:16 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-03-19 21:34:16 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-03-19 21:34:16 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:34:16 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:34:16 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:34:16 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: user1
2025-03-19 21:34:16 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: user1
2025-03-19 21:34:16 WARN  tech.robd.jwt.service.UserService - Invalid password for user: user1
2025-03-19 21:34:16 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:34:37 DEBUG o.s.security.web.FilterChainProxy - Securing POST /authenticate
2025-03-19 21:34:37 DEBUG t.r.j.filter.JwtAuthenticationFilter - No JWT token found in request
2025-03-19 21:34:37 DEBUG o.s.security.web.FilterChainProxy - Secured POST /authenticate
2025-03-19 21:34:37 INFO  t.robd.jwt.controller.AuthController - Authentication request received for username: user1
2025-03-19 21:34:37 DEBUG tech.robd.jwt.service.UserService - Validating credentials for user: user1
2025-03-19 21:34:37 INFO  tech.robd.jwt.service.UserService - Credentials validated successfully for user: user1
2025-03-19 21:34:37 INFO  t.robd.jwt.controller.AuthController - Authentication successful for user 'user1'
2025-03-19 21:34:37 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:38:27 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/isuservalid
2025-03-19 21:38:27 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: user1
2025-03-19 21:38:27 DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/isuservalid
2025-03-19 21:40:41 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/isuservalid
2025-03-19 21:40:41 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: user1
2025-03-19 21:40:41 DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/isuservalid
2025-03-19 21:42:09 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/rest/users
2025-03-19 21:42:09 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: user1
2025-03-19 21:42:09 DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/rest/users
2025-03-19 21:42:26 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/rest/users/1
2025-03-19 21:42:26 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: user1
2025-03-19 21:42:26 DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/rest/users/1
2025-03-19 21:42:26 ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.http.converter.HttpMessageConversionException: Type definition error: [simple type, class tech.robd.jwt.entity.User]] with root cause
com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Invalid Object Id definition for `tech.robd.jwt.entity.User`: cannot find property with name 'id'
	at com.fasterxml.jackson.databind.exc.InvalidDefinitionException.from(InvalidDefinitionException.java:77)
	at com.fasterxml.jackson.databind.SerializerProvider.reportBadDefinition(SerializerProvider.java:1308)
	at com.fasterxml.jackson.databind.SerializerProvider._createAndCacheUntypedSerializer(SerializerProvider.java:1455)
	at com.fasterxml.jackson.databind.SerializerProvider.findValueSerializer(SerializerProvider.java:626)
	at org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module$PersistentEntityResourceSerializer.hasScalarSerializer(PersistentEntityJackson2Module.java:219)
	at org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module$PersistentEntityResourceSerializer.serialize(PersistentEntityJackson2Module.java:179)
	at org.springframework.data.rest.webmvc.json.PersistentEntityJackson2Module$PersistentEntityResourceSerializer.serialize(PersistentEntityJackson2Module.java:153)
	at com.fasterxml.jackson.databind.ser.DefaultSerializerProvider._serialize(DefaultSerializerProvider.java:479)
	at com.fasterxml.jackson.databind.ser.DefaultSerializerProvider.serializeValue(DefaultSerializerProvider.java:318)
	at com.fasterxml.jackson.databind.ObjectWriter$Prefetch.serialize(ObjectWriter.java:1572)
	at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1061)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writeInternal(AbstractJackson2HttpMessageConverter.java:483)
	at org.springframework.http.converter.AbstractGenericHttpMessageConverter.write(AbstractGenericHttpMessageConverter.java:103)
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodProcessor.writeWithMessageConverters(AbstractMessageConverterMethodProcessor.java:297)
	at org.springframework.web.servlet.mvc.method.annotation.HttpEntityMethodProcessor.handleReturnValue(HttpEntityMethodProcessor.java:245)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:78)
	at org.springframework.hateoas.server.mvc.RepresentationModelProcessorHandlerMethodReturnValueHandler.handleReturnValue(RepresentationModelProcessorHandlerMethodReturnValueHandler.java:134)
	at org.springframework.web.method.support.HandlerMethodReturnValueHandlerComposite.handleReturnValue(HandlerMethodReturnValueHandlerComposite.java:78)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:136)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:884)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:974)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1011)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:110)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:365)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilterInternal(BasicAuthenticationFilter.java:168)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at tech.robd.jwt.filter.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:66)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:166)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:391)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:894)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-03-19 21:42:26 DEBUG o.s.security.web.FilterChainProxy - Securing GET /error
2025-03-19 21:42:26 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-03-19 21:42:26 DEBUG o.s.s.w.s.HttpSessionRequestCache - Saved request http://localhost:8081/error?continue to session
2025-03-19 21:42:26 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2025-03-19 21:42:26 DEBUG o.s.s.w.a.DelegatingAuthenticationEntryPoint - No match found. Using default entry point org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint@1542e7be
2025-03-19 21:42:30 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/rest/users
2025-03-19 21:42:30 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: user1
2025-03-19 21:42:30 DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/rest/users
2025-03-19 21:42:39 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/rest/users?id=1
2025-03-19 21:42:39 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: user1
2025-03-19 21:42:39 DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/rest/users?id=1
2025-03-19 21:42:52 DEBUG o.s.security.web.FilterChainProxy - Securing GET /api/rest/domains
2025-03-19 21:42:52 DEBUG t.r.j.filter.JwtAuthenticationFilter - Valid JWT token found for user: user1
2025-03-19 21:42:52 DEBUG o.s.security.web.FilterChainProxy - Secured GET /api/rest/domains
